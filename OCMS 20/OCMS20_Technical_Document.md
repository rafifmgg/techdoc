# OCMS 20 – Unclaimed Reminders & HST Suspension

**Prepared by**

[COMPANY LOGO]

[COMPANY NAME]

---

## Version History

| Version | Updated By | Date | Changes |
|---------|------------|------|---------|
| v1.0 | [Author Name] | 07/01/2026 | Document Initiation |
| v1.1 | [Author Name] | 07/01/2026 | Added JSON examples, eligibility matrix, dropdown sources |

---

## Table of Content

| Section | Content | Pages |
|---------|---------|-------|
| 1 | Manage Unclaimed Reminders | - |
| 1.1 | Use Case | - |
| 1.2 | Submit Unclaimed Reminder Flow | - |
| 1.2.1 | API Specification | - |
| 1.2.2 | Data Mapping | - |
| 1.2.3 | Success Outcome | - |
| 1.2.4 | Error Handling | - |
| 1.3 | Unclaimed Batch Data Report Flow | - |
| 1.3.1 | Data Mapping | - |
| 1.3.2 | Success Outcome | - |
| 1.3.3 | Error Handling | - |
| 2 | HST Suspension | - |
| 2.1 | Use Case | - |
| 2.2 | Manual HST Suspension Flow | - |
| 2.2.1 | API Specification | - |
| 2.2.2 | Data Mapping | - |
| 2.2.3 | Success Outcome | - |
| 2.2.4 | Error Handling | - |
| 2.3 | Manual HST Update Flow | - |
| 2.3.1 | API Specification | - |
| 2.3.2 | Data Mapping | - |
| 2.3.3 | Success Outcome | - |
| 2.3.4 | Error Handling | - |
| 2.4 | Manual HST Revival Flow | - |
| 2.4.1 | API Specification | - |
| 2.4.2 | Data Mapping | - |
| 2.4.3 | Success Outcome | - |
| 2.4.4 | Error Handling | - |
| 2.5 | Monthly DataHive/MHA Check Flow | - |
| 2.5.1 | Data Mapping | - |
| 2.5.2 | Success Outcome | - |
| 2.5.3 | Error Handling | - |
| 2.6 | Auto-Suspend New Notices Flow | - |
| 2.6.1 | Data Mapping | - |
| 2.6.2 | Success Outcome | - |
| 2.6.3 | Error Handling | - |
| 2.7 | TS-HST Looping Mechanism | - |
| 2.7.1 | Success Outcome | - |
| 2.8 | View HST List Flow | - |
| 2.8.1 | API Specification | - |
| 2.8.2 | Data Mapping | - |
| 2.8.3 | Success Outcome | - |
| 2.8.4 | Error Handling | - |
| 2.9 | HST Database Tables Reference | - |
| Appendix A | API Endpoints with Request/Response Examples | - |
| Appendix B | ID Number Format Validation | - |
| Appendix C | Suspension Type Reference | - |
| Appendix D | Suspension Eligibility Decision Matrix | - |
| Appendix E | Dropdown Sources (Parameter Tables) | - |

---

# Section 1 – Manage Unclaimed Reminders

## 1.1 Use Case

1. Unclaimed Reminders refer to Reminder Letters that have been returned to URA as the Offender is no longer residing at the address or did not claim their mail.

2. The OCMS Staff Portal has an Unclaimed module that allows OCMS OICs to:<br>a. Fill in the Unclaimed Reminder form on screen so that it can be generated by the backend as an Unclaimed Reminder Report for user to download<br>b. Trigger the OCMS backend to apply the TS-UNC suspension and save the return details in OCMS<br>c. Retrieve and download the Unclaimed Batch Data Report from the backend to view the Offender particulars returned by MHA and DataHive

3. When the TS-UNC suspension is initiated from the Portal, the OCMS Backend will:<br>a. Update the following data to the corresponding RDP or DN record in the database: Date of Return, Reason for Return, Remarks on Envelope<br>b. Generate the Unclaimed Reminder Report<br>c. Apply the TS-UNC suspension to the Notice with the Unclaimed Reminder<br>d. Save the return details in the Request Driver Particulars, Driver Notice and Suspended Notice tables<br>e. Schedule the Notice for Offender Particulars check with MHA and DataHive to identify if there is a new address so that OICs can decide if another Reminder Letter should be sent<br>f. An Unclaimed Batch Data Report will be generated when the data from MHA and DataHive is returned

4. Important points to note:<br>a. When the Unclaimed Reminder Report is generated for export, the Report file will be stored in the file storage so that the file can be retrieved by the OIC for viewing<br>b. There is no requirement from users to store the Unclaimed Batch Data Report data in the database<br>c. When the Unclaimed Batch Data Report is generated, the Report file will be stored in the file storage so that the file can be retrieved by the OIC for viewing

## 1.2 Submit Unclaimed Reminder Flow

![Flow Diagram](Refer to OCMS20_Unclaimed_Flowchart.drawio - Unclaimed_User_Journey, Unclaimed_Backend_Submit tabs - for detailed flow.)

*NOTE: Due to page size limit, the full-sized image is appended.*

### User Journey (Frontend)

| Step | Description | Brief Description |
|------|-------------|-------------------|
| Launch Portal | OIC launches Staff Portal and navigates to Unclaimed module | Navigate to module |
| Select Reminders | OIC selects "Reminders" function | Select reminders |
| Choose Input Mode | OIC selects input mode: Manual entry or Excel upload | Select input mode |
| Enter Notice No | (Manual) OIC enters Notice Number in the input field | Input notice number |
| Upload Template | (Excel) OIC uploads Excel template file with Notice Numbers | Upload file |
| Validate Data | Portal validates uploaded data and displays any errors | Validate input |
| Submit Query | OIC clicks Submit to query Notice details | Query notices |
| Display Details | Portal displays Notice and Letter details from check-unclaimed API | Show notice info |
| Check Eligibility | If Notice has PS or Court status, suspension fields are disabled | Eligibility check |
| Fill Form | OIC fills Return Date and Unclaimed Reason (Suspension Code = UNC) | Complete form |
| Submit Unclaimed | OIC clicks Submit to process unclaimed reminder | Submit form |
| Show Success | Portal displays success message and auto-downloads Report | Display result |

### Backend Processing (API)

| Step | Description | Brief Description |
|------|-------------|-------------------|
| Receive Request | Backend receives POST /v1/submit-unclaimed API request | Receive API |
| Validate JWT | Validate JWT Authentication token | Auth check |
| JWT Invalid | If JWT invalid: Return error OCMS-4001 | Auth error |
| Validate Payload | Validate payload: noticeNo, reasonOfSuspension required | Validate input |
| Payload Invalid | If payload invalid: Return error OCMS-4000/4003/4004 | Validation error |
| Loop Notices | FOR EACH notice in request, process the following steps | Loop start |
| Query VON | Query ocms_valid_offence_notice to validate notice exists | Validate notice |
| Notice Not Found | If notice not found: Log error and skip record | Skip invalid |
| Update RDP/DN | UPDATE ocms_request_driver_particulars or ocms_driver_notice with date_of_return and unclaimed_reason | Update return info |
| Get MAX sr_no | Get MAX(sr_no) from ocms_suspended_notice for this notice | Get sequence |
| Update VON | UPDATE ocms_valid_offence_notice with suspension_type, epr_reason_of_suspension, epr_date_of_suspension | Update VON suspension fields |
| Insert Suspension | INSERT to ocms_suspended_notice with TS-UNC suspension type | Create suspension |
| Insert NRO Temp | INSERT to ocms_nro_temp for MHA/DataHive query scheduling | Queue for query |
| More Records? | Check if more notices to process, loop back if yes | Loop check |
| Generate Report | Generate Unclaimed Reminder Report (Excel) | Create report |
| Report Error | If report generation fails: Return error OCMS-5001 | Report error |
| Upload to Blob | Upload Report to Azure Blob Storage (path: unclaimed/[timestamp]-Report.xlsx) | Upload report |
| Upload Error | If upload fails: Return error OCMS-5004 | Upload error |
| Return Response | Return success response with Report URL | Return success |

### 1.2.1 API Specification

#### API Check Unclaimed

| Field | Value |
|-------|-------|
| API Name | check-unclaimed |
| URL | UAT: https://[domain]/ocms/v1/check-unclaimed <br> PRD: https://[domain]/ocms/v1/check-unclaimed |
| Description | Validate notice numbers and retrieve Notice & Reminder Letter details |
| Method | POST |
| Header | `{ "Authorization": "Bearer [token]", "Content-Type": "application/json" }` |
| Payload | `{ "noticeNumbers": ["500500001A", "500500002B"] }` |
| Response | `{ "data": { "appCode": "OCMS-2000", "message": "Success", "records": [{ "noticeNo": "500500001A", "dateOfLetter": "2025-11-22 00:00:00", "lastProcessingStage": "RD1", "idNumber": "S1234567A", "idType": "N", "ownerHirerIndicator": "O", "validationStatus": "OK" }] } }` |
| Response (Empty) | `{ "data": { "appCode": "OCMS-2000", "message": "Success", "records": [] } }` |
| Response Failure | `{ "data": { "appCode": "OCMS-4000", "message": "noticeNumbers is required" } }` |

#### API Submit Unclaimed Reminder

| Field | Value |
|-------|-------|
| API Name | submit-unclaimed |
| URL | UAT: https://[domain]/ocms/v1/submit-unclaimed <br> PRD: https://[domain]/ocms/v1/submit-unclaimed |
| Description | Process unclaimed reminder submissions, apply TS-UNC suspension, generate report |
| Method | POST |
| Header | `{ "Authorization": "Bearer [token]", "Content-Type": "application/json" }` |
| Payload | `[{ "noticeNo": "500500001A", "dateOfLetter": "2025-11-22 00:00:00", "lastProcessingStage": "RD1", "idNumber": "S1234567A", "idType": "N", "ownerHirerIndicator": "O", "dateOfReturn": "2025-11-23 00:00:00", "reasonForUnclaim": "NSP", "unclaimRemarks": "-", "reasonOfSuspension": "UNC", "daysOfRevival": 10, "suspensionRemarks": "-" }]` |
| Response | `{ "data": { "appCode": "OCMS-2000", "message": "Success", "reportName": "unclaimed/2025112300481928-Unclaimed-Report.xlsx" } }` |
| Response Failure | `{ "data": { "appCode": "OCMS-5001", "message": "Error generating report" } }` |

### 1.2.2 Data Mapping

| Zone | Database Table | Field Name | Source/Description |
|------|----------------|------------|-------------------|
| Frontend | - | notice_no (input) | User input or Excel upload |
| Frontend | - | date_of_return (input) | User input (date picker) |
| Frontend | - | unclaimed_reason (dropdown) | Standard Code DB |
| Frontend | - | envelope_remarks (input) | User input (optional) |
| Backend | ocms_valid_offence_notice | notice_no | SELECT - Validate notice exists |
| Backend | ocms_valid_offence_notice | suspension_type, epr_reason_of_suspension, epr_date_of_suspension, upd_date, upd_user_id | UPDATE suspension fields (suspension_type='TS', epr_reason_of_suspension='UNC') |
| Backend | ocms_offence_notice_owner_driver | name, id_no, id_type | Offender details |
| Backend | ocms_offence_notice_owner_driver_addr | postal_code, blk_hse_no, street_name, floor_no, unit_no | Offender address |
| Backend | ocms_request_driver_particulars | date_of_return, unclaimed_reason, upd_date, upd_user_id | UPDATE with return details |
| Backend | ocms_driver_notice | date_of_return, reason_for_unclaim, upd_date, upd_user_id | UPDATE with return details |
| Backend | ocms_suspended_notice | notice_no, sr_no, suspension_type, suspension_source, date_of_suspension, reason_of_suspension, officer_authorising_suspension, due_date_of_revival, cre_date, cre_user_id | INSERT TS-UNC suspension |
| Backend | ocms_nro_temp | notice_no, id_no, id_type, query_reason, cre_date, cre_user_id | INSERT for MHA/DataHive query |
| Storage | Azure Blob | unclaimed/[timestamp]-Report.xlsx | Unclaimed Reminder Report |

### 1.2.3 Success Outcome

- VON suspension fields updated (UPDATE ocms_valid_offence_notice SET suspension_type='TS', epr_reason_of_suspension='UNC', epr_date_of_suspension=GETDATE())
- TS-UNC suspension applied successfully to the Notice (INSERT to ocms_suspended_notice)
- Return details saved to RDP/DN record (UPDATE ocms_request_driver_particulars or ocms_driver_notice)
- Record queued for MHA/DataHive query (INSERT to ocms_nro_temp with query_reason='UNC')
- Unclaimed Reminder Report generated and stored in Azure Blob Storage
- Report auto-downloaded to OIC via Portal

### 1.2.4 Error Handling

#### Application Error Handling

| Error Scenario | Definition | Brief Description |
|----------------|------------|-------------------|
| Notice Not Found | Notice number does not exist in ocms_valid_offence_notice table | Display error message, prompt re-entry |
| Notice Not Eligible | Notice is in Court stage or already has PS suspension | Display eligibility error |
| Report Generation Failed | Excel template processing error | Log error, notify admin |

#### API Error Handling

| Error Scenario | App Error Code | User Message | Brief Description |
|----------------|----------------|--------------|-------------------|
| Required Field Missing | OCMS-4000 | Please fill in all required fields | Notice number not provided |
| Authentication Failed | OCMS-4001 | Session expired. Please login again | JWT validation failed |
| Notice Not Found | OCMS-4002 | Notice not found. Please check and try again | Invalid notice number |
| Not Eligible | OCMS-4003 | Notice is not eligible for suspension | Court stage or PS exists |
| Report Error | OCMS-5001 | Report generation failed. Please try again | Excel generation error |
| Storage Error | OCMS-5004 | File upload failed. Please try again | Azure blob error |

## 1.3 Unclaimed Batch Data Report Flow

![Flow Diagram](Refer to OCMS20_Unclaimed_Flowchart.drawio - Unclaimed_Batch_Report tab - for detailed flow.)

*NOTE: Due to page size limit, the full-sized image is appended.*

**Shedlock Job Name:** `generate_unc_batch_data_report`

**PRE-CONDITION:** IDs for query are added to ocms_nro_temp from Submit Unclaimed process (Section 1.2)

| Step | Description | Brief Description |
|------|-------------|-------------------|
| Cron Start | Cron job is triggered by scheduler | Start cron |
| Record Job Start | Record job start in ocms_batch_job table with start_run timestamp | Track job start |
| Query NRO Temp | Query ocms_nro_temp for IDs to send to MHA (WHERE query_reason='UNC') | Get pending IDs |
| Send to MHA | Send IDs to MHA via SFTP | SFTP upload |
| Wait for MHA | Wait for MHA results asynchronously | Async wait |
| MHA Results | MHA results processing cron receives results | Receive results |
| Check Stage Change | Check if result is for processing stage change | Routing check |
| Standard Flow | If stage change: Continue standard flow (update ONOD) | Standard process |
| Store Address | If not stage change: Store address in ocms_temp_unc_hst_addr | Store temp address |
| Query DataHive | Query DataHive API for NRIC/FIN/UEN addresses | Call DataHive |
| Consolidate Results | Consolidate all MHA and DataHive results | Merge results |
| Check UNC Results | Check for unprocessed UNC results in ocms_temp_unc_hst_addr (WHERE query_reason='UNC' AND report_generated='N') | Query pending |
| No Records | If no records found: Log and skip to end | Skip if empty |
| Generate Report | Generate Unclaimed Batch Data Report (Excel with 15 columns) | Create report |
| Upload to Blob | Upload report to Azure Blob Storage | Upload report |
| Save Report URL | Save report URL to database | Save URL |
| Mark Processed | UPDATE ocms_temp_unc_hst_addr SET report_generated='Y' for processed records | Mark complete |
| Delete Temp Tables | DELETE UNC records from ocms_temp_unc_hst_addr and ocms_nro_temp | Cleanup temp data |
| Update Job Status | UPDATE ocms_batch_job SET run_status='SUCCESS', end_run=GETDATE() | Track job end |
| End | Cron job completes | End cron |

### 1.3.1 Data Mapping

| Zone | Database Table | Field Name | Source/Description |
|------|----------------|------------|-------------------|
| Backend | ocms_batch_job | name, run_status, log_text, start_run, end_run, cre_date, cre_user_id, upd_date, upd_user_id | Batch job tracking |
| Backend | ocms_nro_temp | notice_no, id_no, id_type, query_reason | INPUT: Queue for MHA/DataHive query (SELECT then DELETE) |
| External | MHA SFTP | Request file, Response file | MHA Integration (refer to MHA Technical Document) |
| External | DataHive API | NRIC/FIN query, UEN query | DataHive Integration (refer to DataHive Technical Document) |
| Backend | ocms_temp_unc_hst_addr | id_no, type_of_address, blk_hse_no, street_name, floor_no, unit_no, postal_code, query_reason, report_generated, cre_date, cre_user_id, upd_date, upd_user_id | OUTPUT: Temp address storage (INSERT, UPDATE, DELETE) |
| Storage | Azure Blob | unclaimed-batch-data/[timestamp]-Report.xlsx | Unclaimed Batch Data Report |

### 1.3.2 Success Outcome

- Batch job start recorded in ocms_batch_job table (INSERT with start_run timestamp, cre_user_id='ocmsiz_app_conn')
- MHA query completed and results stored in ocms_temp_unc_hst_addr
- DataHive query completed and results stored in ocms_temp_unc_hst_addr
- Unclaimed Batch Data Report generated (Excel with 15 columns) and stored in Azure Blob Storage
- Processed records marked as complete (UPDATE ocms_temp_unc_hst_addr SET report_generated='Y')
- Temp tables cleaned up (DELETE from ocms_temp_unc_hst_addr and ocms_nro_temp WHERE query_reason='UNC')
- Batch job status updated to SUCCESS in ocms_batch_job (UPDATE with run_status='SUCCESS', end_run, upd_user_id='ocmsiz_app_conn')
- OIC can download report from Staff Portal to view new address information (if found)

### 1.3.3 Error Handling

#### Application Error Handling

| Error Scenario | Definition | Brief Description |
|----------------|------------|-------------------|
| MHA Connection Failed | SFTP connection to MHA unavailable | Retry 3 times, then alert |
| DataHive API Failed | DataHive API returns error | Retry 3 times, then alert |
| Report Generation Failed | Excel generation error | Log error, continue with next batch |

#### API Error Handling

| Error Scenario | App Error Code | User Message | Brief Description |
|----------------|----------------|--------------|-------------------|
| Report Error | OCMS-5001 | Report generation failed | Excel generation error |
| Storage Error | OCMS-5004 | File upload failed | Azure blob error |

---

# Section 2 – HST Suspension

## 2.1 Use Case

1. Following the review of unclaimed offenders' latest addresses (refer to Section 1), OICs may apply a TS-HST suspension to a Notice by recording the ID as HST if the address retrieved from MHA or DataHive matches the address used for the Unclaimed Reminder Letter.

2. This scenario typically arises when the offender (house tenant) has relocated but failed to update their particulars with the relevant government agencies.

3. After an ID is added to the HST table and the Notice(s) is suspended with TS-HST, OCMS performs a monthly query to MHA and DataHive to determine if a new address is available.

4. If a new address is available, OCMS will notify the OIC via the monthly reports so that the OIC can perform the following follow-up actions:<br>a. Update the Offender's address<br>b. Revive the TS-HST suspension

5. The OCMS Staff Portal has an HST module that allows OCMS OICs to:<br>a. Create an HST record for an Offender ID and trigger a TS-HST to all outstanding Notices under the ID<br>b. Update the Offender's name and/or address in the HST table<br>c. Revive all TS-HST suspensions under the ID and remove the Offender's HST record

6. When a HST record is created, all outstanding Notices under the ID will be suspended with TS-HST.

7. The OCMS backend has a set of pre-defined tasks that will be performed automatically:<br>a. Suspend all new notices under the ID with TS-HST before they enter the RD1 processing stage<br>b. Query MHA and DataHive on the first calendar day of each month to check whether a new address is available and notify the OIC via a Work Item Report if a new address is available<br>c. Re-apply the TS-HST suspension immediately after the existing suspension expires

## 2.2 Manual HST Suspension Flow

![Flow Diagram](Refer to OCMS20_HST_Flowchart.drawio - HST_Manual_Suspend_User_Journey, HST_Manual_Suspend_Backend tabs - for detailed flow.)

*NOTE: Due to page size limit, the full-sized image is appended.*

| Step | Description | Brief Description |
|------|-------------|-------------------|
| Launch Portal | OIC launches Staff Portal and navigates to HST module | Navigate to module |
| Select Function | OIC selects "Manual HST Suspension" function | Select apply function |
| Enter ID | OIC enters Offender ID Number | Input offender ID |
| Auto-detect Type | Staff Portal auto-detects ID Type based on format | Determine ID type |
| Check HST | Staff Portal queries Backend to check if ID is already in HST table | Validate HST status |
| ID in HST | If ID already in HST: Returns error "ID is suspended under HST" | Block duplicate |
| ID not in HST | If ID not in HST: Returns offender details and latest address | Return details |
| Display Info | Staff Portal displays offender name and address for OIC review | Show for review |
| Apply HST | OIC reviews/edits details and clicks "Apply HST" | Confirm apply |
| Create Record | Backend creates record in ocms_hst table | Insert HST record |
| Suspend Notices | Backend suspends all notices under ID with TS-HST | Apply TS-HST |
| Show Success | Staff Portal displays success message with list of suspended notices | Display result |

### 2.2.1 API Specification

#### API Check HST Status

| Field | Value |
|-------|-------|
| API Name | hstexists |
| URL | UAT: https://[domain]/ocms/v1/hstexists <br> PRD: https://[domain]/ocms/v1/hstexists |
| Description | Check if offender ID is already suspended under HST |
| Method | POST |
| Header | `{ "Authorization": "Bearer [token]", "Content-Type": "application/json" }` |
| Payload | `{ "idNo": "S1234567A" }` |
| Response (Not in HST) | `{ "data": { "appCode": "OCMS-2000", "message": "Success", "exists": false } }` |
| Response (In HST) | `{ "data": { "appCode": "OCMS-2000", "message": "Success", "exists": true, "hstRecord": { "idNo": "S1234567A", "idType": "N", "name": "John Tan", "postalCode": "123456", "blkHseNo": "123", "streetName": "Example Street", "floorNo": "01", "unitNo": "01", "bldgName": "Example Building" } } }` |
| Response Failure | `{ "data": { "appCode": "OCMS-4000", "message": "idNo is required" } }` |

#### API Apply HST Suspension

| Field | Value |
|-------|-------|
| API Name | apply-hst |
| URL | UAT: https://[domain]/ocms/v1/apply-hst <br> PRD: https://[domain]/ocms/v1/apply-hst |
| Description | Create HST record and suspend all notices under this ID with TS-HST |
| Method | POST |
| Header | `{ "Authorization": "Bearer [token]", "Content-Type": "application/json" }` |
| Payload | `{ "idNo": "S1234567A", "name": "John Tan", "streetName": "Example Street", "blkHseNo": "123", "floorNo": "01", "unitNo": "01", "bldgName": "Example Building", "postalCode": "123456" }` |
| Response | `{ "data": { "appCode": "OCMS-2000", "message": "HST applied successfully", "suspendedNotices": [{ "noticeNo": "500500001A", "status": "OK" }, { "noticeNo": "500500002B", "status": "OK" }] } }` |
| Response Failure (ID Required) | `{ "data": { "appCode": "OCMS-4000", "message": "idNo is required" } }` |
| Response Failure (Already Exists) | `{ "data": { "appCode": "OCMS-4001", "message": "HST ID already exists in system" } }` |

### 2.2.2 Data Mapping

| Zone | Database Table | Field Name | Source/Description |
|------|----------------|------------|-------------------|
| Frontend | - | id_no (input) | User input (NRIC/FIN/UEN) |
| Frontend | - | id_type (auto-detected) | Auto-detected from ID format (N/F/U) |
| Frontend | - | name, postal_code, blk_hse_no, street_name, floor_no, unit_no, bldg_name | User input (editable, pre-filled from ONOD) |
| Backend | ocms_hst | id_no, id_type, name, postal_code, blk_hse_no, street_name, floor_no, unit_no, bldg_name | INSERT new HST record |
| Backend | ocms_hst | cre_date, cre_user_id | Audit fields (cre_user_id='ocmsiz_app_conn') |
| Backend | ocms_valid_offence_notice | suspension_type, epr_reason_of_suspension, epr_date_of_suspension, upd_date, upd_user_id | UPDATE suspension fields (suspension_type='TS', epr_reason_of_suspension='HST') |
| Backend | ocms_suspended_notice | notice_no, sr_no, suspension_type, reason_of_suspension, date_of_suspension, cre_date, cre_user_id | INSERT TS-HST suspension for each notice |
| Backend | ocms_offence_notice_owner_driver | id_no, notice_no | SELECT notices under this ID |

### 2.2.3 Success Outcome

- HST record created in ocms_hst table
- VON suspension fields updated for each notice (UPDATE ocms_valid_offence_notice SET suspension_type='TS', epr_reason_of_suspension='HST', epr_date_of_suspension=GETDATE())
- All notices under the offender ID suspended with TS-HST (INSERT to ocms_suspended_notice)
- List of suspended notices displayed to OIC
- If no notices found, message indicates "HST ID created successfully. There were no Notices to suspend."

### 2.2.4 Error Handling

#### Application Error Handling

| Error Scenario | Definition | Brief Description |
|----------------|------------|-------------------|
| ID Already in HST | Offender ID already exists in ocms_hst table | Display error, block creation |
| Invalid ID Format | ID does not match NRIC/FIN/UEN pattern | Display format error |
| No Offender Found | ID not found in ocms_offence_notice_owner_driver | Display not found error |

#### API Error Handling

| Error Scenario | App Error Code | User Message | Brief Description |
|----------------|----------------|--------------|-------------------|
| Required Field Missing | OCMS-4000 | idNo is required | idNo not provided |
| Already in HST | OCMS-4001 | HST ID already exists in system | Duplicate HST creation |
| Server Error | OCMS-5000 | Error applying HST suspension | Database/server error |

## 2.3 Manual HST Update Flow

![Flow Diagram](Refer to OCMS20_HST_Flowchart.drawio - HST_Update_User_Journey, HST_Update_Backend tabs - for detailed flow.)

*NOTE: Due to page size limit, the full-sized image is appended.*

| Step | Description | Brief Description |
|------|-------------|-------------------|
| Select HST Record | OIC navigates to HST module and selects HST record | Select record |
| Update Address | OIC updates address fields with new address from MHA/DataHive | Edit address |
| Submit Update | OIC clicks "Update HST" | Confirm update |
| Update HST | Backend updates ocms_hst record with new address | Update HST table |
| Update Notices | Backend updates address in ocms_offence_notice_owner_driver_addr | Update notice addresses |
| Show Success | Staff Portal displays success message | Display result |

### 2.3.1 API Specification

#### API Update HST Record

| Field | Value |
|-------|-------|
| API Name | update-hst |
| URL | UAT: https://[domain]/ocms/v1/update-hst/{idNo} <br> PRD: https://[domain]/ocms/v1/update-hst/{idNo} |
| Description | Update HST record with new address when found via DataHive/MHA |
| Method | POST |
| Path Parameter | `idNo` - The offender ID number (e.g., S1234567A) |
| Header | `{ "Authorization": "Bearer [token]", "Content-Type": "application/json" }` |
| Payload | `{ "name": "John Tan Updated", "streetName": "New Street", "blkHseNo": "456", "floorNo": "02", "unitNo": "02", "bldgName": "New Building", "postalCode": "654321" }` |
| Response | `{ "data": { "appCode": "OCMS-2000", "message": "HST record updated", "updatedNotices": [{ "noticeNo": "500500001A", "status": "OK" }] } }` |
| Response Failure | `{ "data": { "appCode": "OCMS-4001", "message": "HST ID not found in system" } }` |

### 2.3.2 Data Mapping

| Zone | Database Table | Field Name | Source/Description |
|------|----------------|------------|-------------------|
| Frontend | - | name, postal_code, blk_hse_no, street_name, floor_no, unit_no, bldg_name | User input (new address from MHA/DataHive report) |
| Backend | ocms_hst | name, postal_code, blk_hse_no, street_name, floor_no, unit_no, bldg_name | UPDATE HST record with new address |
| Backend | ocms_hst | upd_date, upd_user_id | Audit fields (upd_user_id='ocmsiz_app_conn') |
| Backend | ocms_offence_notice_owner_driver_addr | postal_code, blk_hse_no, street_name, floor_no, unit_no, bldg_name | UPDATE address for all notices under HST ID |

### 2.3.3 Success Outcome

- HST record updated with new address
- All notice address records updated
- Success message displayed with count of notices updated

### 2.3.4 Error Handling

#### Application Error Handling

| Error Scenario | Definition | Brief Description |
|----------------|------------|-------------------|
| HST Not Found | ID does not exist in ocms_hst table | Display error message |
| Update Failed | Database update error | Log error, display message |

#### API Error Handling

| Error Scenario | App Error Code | User Message | Brief Description |
|----------------|----------------|--------------|-------------------|
| HST Not Found | OCMS-4001 | HST ID not found in system | ID not in ocms_hst |
| Server Error | OCMS-5000 | Error updating HST record | Database/server error |

## 2.4 Manual HST Revival Flow

![Flow Diagram](Refer to OCMS20_HST_Flowchart.drawio - HST_Revival_User_Journey, HST_Revival_Backend tabs - for detailed flow.)

*NOTE: Due to page size limit, the full-sized image is appended.*

| Step | Description | Brief Description |
|------|-------------|-------------------|
| Select Function | OIC selects "Manual HST Revival" function | Select revival |
| Enter ID | OIC enters Offender ID Number | Input ID |
| Check HST | Staff Portal queries Backend to check if ID is in HST table | Validate exists |
| Not in HST | If ID not in HST: Returns error "ID is not suspended under HST" | Block if not found |
| In HST | If ID in HST: Returns offender details and HST record | Return details |
| Revive HST | OIC reviews details and clicks "Revive HST" | Confirm revival |
| Delete HST | Backend deletes record from ocms_hst table | Remove HST record |
| Update Suspension | Backend updates date_of_revival in ocms_suspended_notice for all TS-HST records | Mark as revived |
| Show Success | Staff Portal displays success message with list of revived notices | Display result |

### 2.4.1 API Specification

#### API Revive HST Suspension

| Field | Value |
|-------|-------|
| API Name | revive-hst |
| URL | UAT: https://[domain]/ocms/v1/revive-hst <br> PRD: https://[domain]/ocms/v1/revive-hst |
| Description | Lift all HST suspensions under an ID and delete HST record |
| Method | POST |
| Header | `{ "Authorization": "Bearer [token]", "Content-Type": "application/json" }` |
| Payload | `{ "idNo": "S1234567A", "name": "John Tan", "streetName": "Bukit Merah View", "blkHseNo": "65", "floorNo": "29", "unitNo": "1551", "bldgName": "The Amberlyn", "postalCode": "578640" }` |
| Response | `{ "data": { "appCode": "OCMS-2000", "message": "HST revived successfully", "revivedNotices": [{ "noticeNo": "500500001A", "status": "OK" }] } }` |
| Response Failure (ID Required) | `{ "data": { "appCode": "OCMS-4000", "message": "idNo is required" } }` |
| Response Failure (Not Found) | `{ "data": { "appCode": "OCMS-4001", "message": "HST ID not found in system" } }` |

### 2.4.2 Data Mapping

| Zone | Database Table | Field Name | Source/Description |
|------|----------------|------------|-------------------|
| Frontend | - | id_no (input) | User input or selected from HST list |
| Frontend | - | revival_reason, remarks (input) | User input (optional) |
| Backend | ocms_hst | id_no | DELETE record from HST table |
| Backend | ocms_suspended_notice | date_of_revival, revival_reason, officer_authorising_revival, revival_remarks | UPDATE to revive TS-HST suspensions |
| Backend | ocms_suspended_notice | upd_date, upd_user_id | Audit fields (upd_user_id='ocmsiz_app_conn') |

### 2.4.3 Success Outcome

- HST record deleted from ocms_hst table
- All TS-HST suspensions revived (date_of_revival populated)
- Notices continue normal processing flow
- List of revived notices displayed to OIC

### 2.4.4 Error Handling

#### Application Error Handling

| Error Scenario | Definition | Brief Description |
|----------------|------------|-------------------|
| HST Not Found | ID does not exist in ocms_hst table | Display error message |
| Revival Failed | Database error during revival | Log error, display message |

#### API Error Handling

| Error Scenario | App Error Code | User Message | Brief Description |
|----------------|----------------|--------------|-------------------|
| HST Not Found | OCMS-4001 | HST ID not found in system | ID not in ocms_hst |
| Revival Failed | OCMS-4000 | Failed to revive HST suspensions | Database error |

## 2.5 Monthly DataHive/MHA Check Flow

![Flow Diagram](Refer to OCMS20_HST_Flowchart.drawio - HST_Monthly_Cron tab - for detailed flow.)

*NOTE: Due to page size limit, the full-sized image is appended.*

**Shedlock Job Name:** `sync_hst_monthly_report`

| Step | Description | Brief Description |
|------|-------------|-------------------|
| Cron Start | Cron job triggers on 1st of each month | Monthly schedule |
| Record Job Start | Record job start in ocms_batch_job table with start_run timestamp | Track job start |
| Query HST IDs | Query all active HST IDs from ocms_hst | Get active HST |
| No Records | If no active HST IDs found: Log and skip to end | Skip if empty |
| Loop HST IDs | FOR EACH active HST ID, process the following steps | Loop start |
| Query DataHive NRIC/FIN | Send NRIC/FIN IDs to DataHive API | Query individuals |
| Query DataHive UEN | Send UEN IDs to DataHive API (separate query) | Query companies |
| Store Results | Store results in ocms_temp_unc_hst_addr with query_reason='HST' | Save temp data |
| Check Results | Check for HST results in ocms_temp_unc_hst_addr (WHERE query_reason='HST' AND report_generated='N') | Query pending |
| Generate Update Report | Generate HST Address Update Report (if new address found) | Create update report |
| Generate No Address Report | Generate HST No Address Report (if no new address) | Create no-address report |
| Upload to Blob | Upload reports to Azure Blob Storage | Upload reports |
| Mark Processed | UPDATE ocms_temp_unc_hst_addr SET report_generated='Y' for processed records | Mark complete |
| Delete Temp Tables | DELETE HST records from ocms_temp_unc_hst_addr (WHERE query_reason='HST') | Cleanup temp data |
| Update Job Status | UPDATE ocms_batch_job SET run_status='SUCCESS', end_run=GETDATE() | Track job end |
| End | Cron job completes | End cron |

### 2.5.1 Data Mapping

| Zone | Database Table | Field Name | Source/Description |
|------|----------------|------------|-------------------|
| Backend | ocms_batch_job | name, run_status, log_text, start_run, end_run, cre_date, cre_user_id, upd_date, upd_user_id | Batch job tracking (name='sync_hst_monthly_report') |
| Backend | ocms_hst | id_no, id_type | SELECT all active HST IDs |
| External | DataHive API | NRIC/FIN query, UEN query | DataHive Integration (refer to DataHive Technical Document) |
| Backend | ocms_temp_unc_hst_addr | id_no, type_of_address, blk_hse_no, street_name, floor_no, unit_no, postal_code, query_reason, report_generated, cre_date, cre_user_id, upd_date, upd_user_id | OUTPUT: Temp address storage (INSERT, UPDATE, DELETE) |
| Storage | Azure Blob | hst-reports/[timestamp]-HST-Update-Report.xlsx, hst-reports/[timestamp]-HST-NoAddr-Report.xlsx | HST Reports |

### 2.5.2 Success Outcome

- Batch job start recorded in ocms_batch_job table (INSERT with start_run timestamp, cre_user_id='ocmsiz_app_conn')
- All active HST IDs queried against DataHive
- New addresses stored in ocms_temp_unc_hst_addr (INSERT with query_reason='HST')
- HST Address Update Report generated if new address found
- HST No Address Report generated if no new address
- Processed records marked as complete (UPDATE ocms_temp_unc_hst_addr SET report_generated='Y')
- Temp tables cleaned up (DELETE from ocms_temp_unc_hst_addr WHERE query_reason='HST')
- Batch job status updated to SUCCESS in ocms_batch_job (UPDATE with run_status='SUCCESS', end_run, upd_user_id='ocmsiz_app_conn')
- OIC can download reports from Staff Portal to review new addresses and take action

### 2.5.3 Error Handling

| Error Scenario | App Error Code | User Message | Brief Description |
|----------------|----------------|--------------|-------------------|
| DataHive Connection Failed | - | - | Retry 3 times, email alert |
| Report Generation Failed | OCMS-5001 | - | Log error, continue |
| Storage Failed | OCMS-5004 | - | Retry upload |

## 2.6 Auto-Suspend New Notices Flow

![Flow Diagram](Refer to OCMS20_HST_Flowchart.drawio - HST_Manual_Suspend_Backend tab - for detailed flow.)

*NOTE: Due to page size limit, the full-sized image is appended.*

**Shedlock Job Name:** `suspend_hst_new_notice`

| Step | Description | Brief Description |
|------|-------------|-------------------|
| Detect New Notice | Backend detects new notice created for offender ID | New notice trigger |
| Check HST | Backend checks if ID exists in ocms_hst table | Lookup HST |
| ID in HST | If ID in HST: Apply TS-HST suspension before RD1 stage | Auto-suspend |
| ID not in HST | If ID not in HST: Continue normal processing | Normal flow |

### 2.6.1 Data Mapping

| Zone | Database Table | Field Name | Source/Description |
|------|----------------|------------|-------------------|
| Backend | ocms_valid_offence_notice | notice_no | New notice detected by cron/trigger |
| Backend | ocms_offence_notice_owner_driver | id_no, notice_no | SELECT to get offender ID for new notice |
| Backend | ocms_hst | id_no | SELECT to check if ID exists in HST table |
| Backend | ocms_valid_offence_notice | suspension_type, epr_reason_of_suspension, epr_date_of_suspension, upd_date, upd_user_id | UPDATE suspension fields (suspension_type='TS', epr_reason_of_suspension='HST') |
| Backend | ocms_suspended_notice | notice_no, sr_no, suspension_type, reason_of_suspension, date_of_suspension, cre_date, cre_user_id | INSERT TS-HST suspension (cre_user_id='ocmsiz_app_conn') |

### 2.6.2 Success Outcome

- VON suspension fields updated (UPDATE ocms_valid_offence_notice SET suspension_type='TS', epr_reason_of_suspension='HST', epr_date_of_suspension=GETDATE())
- New notice automatically suspended with TS-HST if offender ID is in HST table (INSERT to ocms_suspended_notice)
- Notice does not proceed to RD1 stage
- Suspension included in monthly reports

### 2.6.3 Error Handling

| Error Scenario | Definition | Brief Description |
|----------------|------------|-------------------|
| HST Check Failed | Unable to query ocms_hst table | Log error, continue normal flow |

## 2.7 TS-HST Looping Mechanism

**Shedlock Job Name:** `reapply_hst_suspension`

| Step | Description | Brief Description |
|------|-------------|-------------------|
| Check Expiring | Cron job checks for expiring TS-HST suspensions | Monitor expiry |
| No New Address | If no new address found from monthly check: Re-apply TS-HST | Re-suspend |
| Loop Continues | Loop continues until new address found or manual revival | Perpetual loop |

### 2.7.1 Success Outcome

- TS-HST suspension automatically re-applied when expired
- Loop continues until OIC manually revives or new address found

## 2.8 View HST List Flow

![Flow Diagram](Refer to OCMS20_HST_Flowchart.drawio - HST_Manual_Suspend_User_Journey tab - for detailed flow.)

*NOTE: Due to page size limit, the full-sized image is appended.*

| Step | Description | Brief Description |
|------|-------------|-------------------|
| Navigate to HST | OIC navigates to HST module | Access module |
| Apply Filters | OIC applies search filters (ID, date range) | Filter records |
| Query Backend | Staff Portal queries Backend for HST list | Retrieve data |
| Display List | Staff Portal displays paginated HST records | Show results |
| Select Record | OIC selects a record for update/revival | Choose action |

### 2.8.1 API Specification

#### API Get HST List

| Field | Value |
|-------|-------|
| API Name | hstlist |
| URL | UAT: https://[domain]/ocms/hstlist <br> PRD: https://[domain]/ocms/hstlist |
| Description | Retrieve list of HST records for Staff Portal display |
| Method | POST |
| Header | `{ "Authorization": "Bearer [token]", "Content-Type": "application/json" }` |
| Payload | `{ "$skip": 0, "$limit": 10, "filter": { "idNo": "", "dateFrom": "2025-01-01", "dateTo": "2026-01-07" } }` |
| Response | `{ "data": { "appCode": "OCMS-2000", "message": "Success", "total": 100, "limit": 10, "skip": 0, "records": [ { "idNo": "S1234567A", "idType": "N", "name": "John Tan", "postalCode": "123456", "blkHseNo": "123", "streetName": "Example Street", "createdDate": "2025-11-01T00:00:00", "noticesCount": 5, "lastDataHiveCheck": "2025-12-01T00:00:00" } ] } }` |
| Response (Empty) | `{ "data": { "appCode": "OCMS-2000", "message": "Success", "total": 0, "limit": 10, "skip": 0, "records": [] } }` |
| Response Failure | `{ "data": { "appCode": "OCMS-4001", "message": "Authentication failed" } }` |

### 2.8.2 Data Mapping

| Zone | Database Table | Field Name | Source/Description |
|------|----------------|------------|-------------------|
| Frontend | - | $skip, $limit | Pagination parameters from request |
| Frontend | - | filter.idNo, filter.dateFrom, filter.dateTo | Search filter parameters from request |
| Backend | ocms_hst | id_no, id_type, name, postal_code, blk_hse_no, street_name, cre_date | SELECT HST records with filters |
| Backend | ocms_suspended_notice | notice_no, suspension_type | COUNT notices per HST ID (WHERE suspension_type='TS' AND reason_of_suspension='HST') |
| Backend | ocms_temp_unc_hst_addr | cre_date | Last DataHive check date per ID |

### 2.8.3 Success Outcome

- HST list displayed with pagination
- Filter results displayed based on search criteria
- OIC can select record for further action

### 2.8.4 Error Handling

#### Application Error Handling

| Error Scenario | Definition | Brief Description |
|----------------|------------|-------------------|
| No Results | No HST records match filter criteria | Display empty state |
| Query Failed | Database query error | Display error message |

#### API Error Handling

| Error Scenario | App Error Code | User Message | Brief Description |
|----------------|----------------|--------------|-------------------|
| Authentication Failed | OCMS-4001 | Session expired. Please login again | JWT validation failed |
| Query Failed | OCMS-5000 | Failed to retrieve HST list | Database error |

---

## 2.9 HST Database Tables Reference

| Table | Purpose |
|-------|---------|
| ocms_hst | HST record master table (stores ID with address). No status column - existence indicates active HST |
| ocms_suspended_notice | Suspension records (TS-HST type). date_of_revival field updated on revival |
| ocms_offence_notice_owner_driver | Current offender info |
| ocms_offence_notice_owner_driver_addr | Offender address history |
| ocms_temp_unc_hst_addr | Temporary address storage from MHA/DataHive (OUTPUT - stores query results) |
| ocms_nro_temp | Temporary NRO query queue for MHA/DataHive (INPUT - stores IDs to be queried) |

### ocms_hst Table Fields

| Database Field | Description | Mandatory |
|----------------|-------------|-----------|
| id_no | Offender ID Number (Primary Key) | Yes |
| id_type | ID Type (N/F/U) | Yes |
| name | Offender Name | Yes |
| postal_code | Postal Code | No |
| blk_hse_no | Block/House Number | No |
| street_name | Street Name | Yes |
| floor_no | Floor Number | No |
| unit_no | Unit Number | No |
| bldg_name | Building Name | No |
| date_of_addr_change | Date when address was updated | No |
| invalid_addr_tag | Flag for invalid address | No |
| addr_indicator | Address indicator code | No |
| cre_date | Created Date | Yes |
| cre_user_id | Created By User ID | Yes |
| upd_date | Updated Date | No |
| upd_user_id | Updated By User ID | No |

### ocms_suspended_notice Table Fields

| Database Field | Description | Mandatory |
|----------------|-------------|-----------|
| notice_no | Notice Number | Yes |
| sr_no | Serial Number | Yes |
| suspension_type | Suspension Type Code (TS-HST, TS-UNC, PS, etc.) | Yes |
| suspension_source | Source of suspension | No |
| date_of_suspension | Date suspension was applied | Yes |
| reason_of_suspension | Reason for suspension | No |
| officer_authorising_suspension | Officer who authorized suspension | No |
| due_date_of_revival | Expected revival date | No |
| suspension_remarks | Additional remarks | No |
| date_of_revival | Actual revival date (populated on revival) | No |
| revival_reason | Reason for revival | No |
| officer_authorising_revival | Officer who authorized revival | No |
| revival_remarks | Revival remarks | No |
| cre_date | Created Date | Yes |
| cre_user_id | Created By User ID | Yes |
| upd_date | Updated Date | No |
| upd_user_id | Updated By User ID | No |

---

## Appendix A: API Endpoints with Request/Response Examples

### A.1 Check Offender HST Status

| Property | Value |
|----------|-------|
| Endpoint | `/v1/hstexists` |
| Method | POST |
| Content-Type | application/json |
| Authentication | Bearer Token |

**Request Body:**
```json
{
  "idNo": "S1234567A"
}
```

**Success Response (200 OK) - Not in HST:**
```json
{
  "data": {
    "appCode": "OCMS-2000",
    "message": "Success",
    "exists": false
  }
}
```

**Success Response (200 OK) - Already in HST:**
```json
{
  "data": {
    "appCode": "OCMS-2000",
    "message": "Success",
    "exists": true,
    "hstRecord": {
      "idNo": "S1234567A",
      "idType": "N",
      "name": "John Tan",
      "postalCode": "123456",
      "blkHseNo": "123",
      "streetName": "Example Street",
      "floorNo": "01",
      "unitNo": "01",
      "bldgName": "Example Building"
    }
  }
}
```

**Error Response (400 Bad Request):**
```json
{
  "data": {
    "appCode": "OCMS-4000",
    "message": "idNo is required"
  }
}
```

---

### A.2 Apply HST Suspension (Manual)

| Property | Value |
|----------|-------|
| Endpoint | `/v1/apply-hst` |
| Method | POST |
| Content-Type | application/json |
| Authentication | Bearer Token |

**Request Body:**
```json
{
  "idNo": "S1234567A",
  "name": "John Tan",
  "postalCode": "123456",
  "blkHseNo": "123",
  "streetName": "Example Street",
  "floorNo": "01",
  "unitNo": "01",
  "bldgName": "Example Building"
}
```

**Note:** `idType` is auto-detected from the ID number format and does not need to be provided in the request.

**Success Response (200 OK):**
```json
{
  "data": {
    "appCode": "OCMS-2000",
    "message": "HST applied successfully",
    "suspendedNotices": [
      {
        "noticeNo": "500500001A",
        "status": "OK"
      },
      {
        "noticeNo": "500500002B",
        "status": "OK"
      }
    ]
  }
}
```

**Error Response - ID Required (400 Bad Request):**
```json
{
  "data": {
    "appCode": "OCMS-4000",
    "message": "idNo is required"
  }
}
```

**Error Response - Already Exists (400 Bad Request):**
```json
{
  "data": {
    "appCode": "OCMS-4001",
    "message": "HST ID already exists in system"
  }
}
```

---

### A.3 Update HST Record (New Address Found)

| Property | Value |
|----------|-------|
| Endpoint | `/v1/update-hst/{idNo}` |
| Method | POST |
| Content-Type | application/json |
| Authentication | Bearer Token |
| Path Parameter | `idNo` - The offender ID number (e.g., S1234567A) |

**Request Body:**
```json
{
  "name": "John Tan Updated",
  "streetName": "New Street",
  "blkHseNo": "456",
  "floorNo": "02",
  "unitNo": "02",
  "bldgName": "New Building",
  "postalCode": "654321"
}
```

**Note:** The `idNo` is passed as a path parameter, not in the request body.

**Success Response (200 OK):**
```json
{
  "data": {
    "appCode": "OCMS-2000",
    "message": "HST record updated",
    "updatedNotices": [
      {
        "noticeNo": "500500001A",
        "status": "OK"
      }
    ]
  }
}
```

**Error Response (400 Bad Request):**
```json
{
  "data": {
    "appCode": "OCMS-4001",
    "message": "HST ID not found in system"
  }
}
```

---

### A.4 Revive HST Suspension

| Property | Value |
|----------|-------|
| Endpoint | `/v1/revive-hst` |
| Method | POST |
| Content-Type | application/json |
| Authentication | Bearer Token |

**Request Body:**
```json
{
  "idNo": "S1234567A",
  "name": "John Tan",
  "streetName": "Bukit Merah View",
  "blkHseNo": "65",
  "floorNo": "29",
  "unitNo": "1551",
  "bldgName": "The Amberlyn",
  "postalCode": "578640"
}
```

**Success Response (200 OK):**
```json
{
  "data": {
    "appCode": "OCMS-2000",
    "message": "HST revived successfully",
    "revivedNotices": [
      {
        "noticeNo": "500500001A",
        "status": "OK"
      },
      {
        "noticeNo": "500500002B",
        "status": "OK"
      }
    ]
  }
}
```

**Error Response - ID Required (400 Bad Request):**
```json
{
  "data": {
    "appCode": "OCMS-4000",
    "message": "idNo is required"
  }
}
```

**Error Response - Not Found (400 Bad Request):**
```json
{
  "data": {
    "appCode": "OCMS-4001",
    "message": "HST ID not found in system"
  }
}
```

---

### A.5 Get HST List (Staff Portal Display)

| Property | Value |
|----------|-------|
| Endpoint | `/hstlist` |
| Method | POST |
| Content-Type | application/json |
| Authentication | Bearer Token |

**Request Body:**
```json
{
  "$skip": 0,
  "$limit": 10,
  "filter": {
    "idNo": "",
    "dateFrom": "2025-01-01",
    "dateTo": "2026-01-07"
  }
}
```

**Success Response (200 OK):**
```json
{
  "data": {
    "appCode": "OCMS-2000",
    "message": "Success",
    "total": 100,
    "limit": 10,
    "skip": 0,
    "records": [
      {
        "idNo": "S1234567A",
        "idType": "N",
        "name": "John Tan",
        "postalCode": "123456",
        "blkHseNo": "123",
        "streetName": "Example Street",
        "createdDate": "2025-11-01T00:00:00",
        "noticesCount": 5,
        "lastDataHiveCheck": "2025-12-01T00:00:00"
      }
    ]
  }
}
```

---

### A.6 External APIs

| Integration | Method | Purpose |
|-------------|--------|---------|
| DataHive | API | Query for latest address information (monthly cron) |
| MHA | SFTP | Query for address via SFTP |

**Note:** Refer to DataHive Integration Technical Document and MHA Integration Technical Document for detailed specifications.

---

## Appendix B: ID Number Format Validation

| ID Type | Format | Pattern |
|---------|--------|---------|
| NRIC (N) | S/T + 7 digits + letter | `^[ST]\d{7}[A-Z]$` |
| FIN (F) | F/G/M + 7 digits + letter | `^[FGM]\d{7}[A-Z]$` |
| UEN (U) | Various formats | Multiple patterns (issued by multiple agencies) |

---

## Appendix C: Suspension Type Reference

| Code | Description | Duration |
|------|-------------|----------|
| TS-HST | House-to-House Search/Tenant | Loops until new address or revival |
| TS-UNC | Unclaimed Reminder | Standard period |
| PS | Prosecution Suspended | Until court decision |
| PS-FP | Full Payment | Permanent |

---

## Appendix D: Suspension Eligibility Decision Matrix

### D.1 TS-HST Suspension Eligibility

A notice CAN be suspended with TS-HST if ALL of the following conditions are met:

| Condition | Check | Result if FALSE |
|-----------|-------|-----------------|
| Notice not PS-suspended | No active PS (Prosecution Suspended) record | Cannot apply TS-HST |
| Notice not in Court stage | Notice status is not in Court processing | Cannot apply TS-HST |
| Notice before RD1 stage | For new notices under existing HST ID | Cannot apply TS-HST |
| No existing TS-HST | Notice does not already have TS-HST suspension | Cannot apply TS-HST |

### D.2 Eligibility Decision Tree

```
                    [New Notice / HST Application]
                              |
              [Is notice already PS-suspended?]
                              |
            +--------[Yes]--------+--------[No]--------+
            |                                          |
     [CANNOT suspend                        [Is notice in Court?]
      with TS-HST]                                    |
                                  +--------[Yes]------+------[No]------+
                                  |                                    |
                           [CANNOT suspend                [For new notices:
                            with TS-HST]                  Is it before RD1?]
                                                                |
                                                 +------[No]----+----[Yes]----+
                                                 |                            |
                                          [CANNOT suspend           [Already has TS-HST?]
                                           with TS-HST]                       |
                                                              +------[Yes]----+----[No]----+
                                                              |                            |
                                                       [CANNOT suspend             [CAN suspend
                                                        with TS-HST]               with TS-HST]
```

### D.3 Suspension Scenario Matrix

| Current Notice State | Has PS? | In Court? | Has TS-HST? | TS-HST Eligible? |
|---------------------|---------|-----------|-------------|------------------|
| Active (pre-RD1) | No | No | No | YES |
| Active (post-RD1) | No | No | No | YES (existing notices) |
| Active | Yes | No | No | NO |
| Active | No | Yes | No | NO |
| Suspended (TS-HST) | No | No | Yes | NO (already suspended) |
| Suspended (TS-UNC) | No | No | No | YES |
| Paid (PS-FP) | Yes | No | No | NO |

### D.4 Payment During HST Suspension

| Scenario | Action | TS-HST Status | Other Notices |
|----------|--------|---------------|---------------|
| Payment made for notice under TS-HST | Payment processed normally | NOT revived (PS-FP applied) | Continue as TS-HST |
| Full payment on HST ID | All notices paid | PS-FP applied to all | HST record remains until revival |

---

## Appendix E: Dropdown Sources (Parameter Tables)

### E.1 Reason for Return (Unclaimed Reminder)

| Field | Source Table | Description |
|-------|--------------|-------------|
| Reason for Return | Standard Code DB | Dropdown values for return reasons |

**Standard Code Values:**

| Code | Description |
|------|-------------|
| UNC | Unclaimed |
| RTS | Return to Sender |
| NAA | No longer at Address |
| OTH | Other |

**Note:** Dropdown values are retrieved from Standard Code DB table. Only active records are returned for dropdown display.

---

*End of Document*
