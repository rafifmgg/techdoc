<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36 Edg/143.0.0.0" version="29.3.1" pages="10">
  <diagram id="tab2_1" name="2.1_High_Level_AN_Processing">
    <mxGraphModel grid="1" page="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" pageScale="1" pageWidth="8000" pageHeight="2000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title_2_1" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=16;fontStyle=1" value="Section 2.1: High-Level Advisory Notices Processing Overview" vertex="1">
          <mxGeometry height="30" width="600" x="40" y="340" as="geometry" />
        </mxCell>
        <mxCell id="sw_backend_2_1" parent="1" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" value="Backend (OCMS API)" vertex="1">
          <mxGeometry height="600" width="2500" x="20" y="380" as="geometry" />
        </mxCell>
        <mxCell id="s2_1_start" parent="sw_backend_2_1" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" value="Start" vertex="1">
          <mxGeometry height="60" width="120" x="40" y="100" as="geometry" />
        </mxCell>
        <mxCell id="s2_1_step1" parent="sw_backend_2_1" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Notice data received from external source or manual creation" vertex="1">
          <mxGeometry height="100" width="140" x="220" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s2_1_step2" parent="sw_backend_2_1" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Validate mandatory fields and create notice in system" vertex="1">
          <mxGeometry height="100" width="140" x="420" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s2_1_step3" parent="sw_backend_2_1" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Verify if notice qualifies as Advisory Notice (AN Qualification check - for non-CES source only)" vertex="1">
          <mxGeometry height="100" width="180" x="620" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s2_1_dec1" parent="sw_backend_2_1" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Qualifies as AN (Advisory Notice)?" vertex="1">
          <mxGeometry height="130" width="130" x="870" y="65" as="geometry" />
        </mxCell>
        <mxCell id="s2_1_fail" parent="sw_backend_2_1" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Process as standard notice" vertex="1">
          <mxGeometry height="80" width="120" x="875" y="270" as="geometry" />
        </mxCell>
        <mxCell id="s2_1_step4" parent="sw_backend_2_1" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Set an_flag=&#39;Y&#39;" vertex="1">
          <mxGeometry height="100" width="150" x="1080" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s2_1_step5" parent="sw_backend_2_1" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Call LTA (Land Transport Authority) API to retrieve vehicle owner particulars" vertex="1">
          <mxGeometry height="100" width="150" x="1310" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s2_1_dec2" parent="sw_backend_2_1" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="eAN Eligible?" vertex="1">
          <mxGeometry height="170" width="180" x="1540" y="45" as="geometry" />
        </mxCell>
        <mxCell id="s2_1_step6" parent="sw_backend_2_1" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Send SMS/Email to vehicle owner" vertex="1">
          <mxGeometry height="100" width="150" x="1800" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s2_1_step7" parent="sw_backend_2_1" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Generate and send physical letter via SLIFT" vertex="1">
          <mxGeometry height="100" width="160" x="1550" y="280" as="geometry" />
        </mxCell>
        <mxCell id="s2_1_step8" parent="sw_backend_2_1" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Create PS-ANS suspension record for qualified AN" vertex="1">
          <mxGeometry height="100" width="160" x="2040" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s2_1_end" parent="sw_backend_2_1" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" value="End" vertex="1">
          <mxGeometry height="60" width="120" x="2280" y="100" as="geometry" />
        </mxCell>
        <mxCell id="s2_1_an_flag_note" parent="sw_backend_2_1" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="&lt;b&gt;ocms_valid_offence_notice:&lt;/b&gt;&lt;br&gt;- an_flag = &#39;Y&#39;&lt;br&gt;- payment_acceptance_allowed = &#39;N&#39;" vertex="1">
          <mxGeometry height="70" width="200" x="1050" y="230" as="geometry" />
        </mxCell>
        <mxCell id="c2_1_an_flag_link" edge="1" parent="sw_backend_2_1" source="s2_1_step4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s2_1_an_flag_note">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s2_1_vip_note" parent="sw_backend_2_1" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="&lt;b&gt;REPCCS VIP (vehicle_registration_type=&#39;V&#39;):&lt;/b&gt;&lt;br&gt;- TS-OLD suspension 21 days&lt;br&gt;- Then AN Qualification check&lt;br&gt;&lt;br&gt;(CES: VIP rule not applied)" vertex="1">
          <mxGeometry height="100" width="220" x="560" y="230" as="geometry" />
        </mxCell>
        <mxCell id="c2_1_vip_link" edge="1" parent="sw_backend_2_1" source="s2_1_step3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s2_1_vip_note">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FnrUfJy9jrTVtbUwV38l-1" parent="sw_backend_2_1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;rounded=0;autosize=1;resizable=0;" value="mobile OR email available AND&amp;nbsp;&lt;div&gt;not in exclusion list AND not suspended&lt;/div&gt;" vertex="1">
          <mxGeometry height="40" width="230" x="1650" y="25" as="geometry" />
        </mxCell>
        <mxCell id="c2_1_1" edge="1" parent="1" source="s2_1_start" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s2_1_step1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c2_1_2" edge="1" parent="1" source="s2_1_step1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s2_1_step2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c2_1_3" edge="1" parent="1" source="s2_1_step2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s2_1_step3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c2_1_4" edge="1" parent="1" source="s2_1_step3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s2_1_dec1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c2_1_5" edge="1" parent="1" source="s2_1_dec1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s2_1_step4" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c2_1_6" edge="1" parent="1" source="s2_1_dec1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s2_1_fail" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c2_1_7" edge="1" parent="1" source="s2_1_step4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s2_1_step5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c2_1_8" edge="1" parent="1" source="s2_1_step5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s2_1_dec2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c2_1_9" edge="1" parent="1" source="s2_1_dec2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s2_1_step6" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c2_1_10" edge="1" parent="1" source="s2_1_dec2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s2_1_step7" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c2_1_11" edge="1" parent="1" source="s2_1_step6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s2_1_step8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c2_1_12" edge="1" parent="1" source="s2_1_step7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s2_1_step8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c2_1_13" edge="1" parent="1" source="s2_1_step8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s2_1_end">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="tab3_1" name="3.1_AN_Verification_Qualification">
    <mxGraphModel dx="1271" dy="745" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="7000" pageHeight="1800" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title_3_2" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=16;fontStyle=1" value="Section 3.1: AN Verification - Qualification Check" vertex="1">
          <mxGeometry height="30" width="500" x="40" y="20" as="geometry" />
        </mxCell>
        <mxCell id="sw_backend_3_2" parent="1" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" value="Backend (OCMS API)" vertex="1">
          <mxGeometry height="700" width="2600" x="20" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_2_start" parent="sw_backend_3_2" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" value="Start" vertex="1">
          <mxGeometry height="60" width="120" x="40" y="100" as="geometry" />
        </mxCell>
        <mxCell id="APUnelsGrHz7-8aDQZV9-2" edge="1" parent="sw_backend_3_2" source="s3_2_step1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;dashPattern=8 8;" target="APUnelsGrHz7-8aDQZV9-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_2_step1" parent="sw_backend_3_2" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Check Offence Type" vertex="1">
          <mxGeometry height="90" width="180" x="220" y="85" as="geometry" />
        </mxCell>
        <mxCell id="s3_2_dec1" parent="sw_backend_3_2" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Offence Notice Type = &#39;O&#39;?" vertex="1">
          <mxGeometry height="120" width="140" x="470" y="70" as="geometry" />
        </mxCell>
        <mxCell id="s3_2_fail1" parent="sw_backend_3_2" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Return Not Qualified: &quot;Offence type must be &#39;O&#39;&quot;" vertex="1">
          <mxGeometry height="100" width="140" x="470" y="290" as="geometry" />
        </mxCell>
        <mxCell id="APUnelsGrHz7-8aDQZV9-4" edge="1" parent="sw_backend_3_2" source="s3_2_step2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;dashPattern=8 8;" target="APUnelsGrHz7-8aDQZV9-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_2_step2" parent="sw_backend_3_2" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Check Vehicle Type" vertex="1">
          <mxGeometry height="90" width="180" x="680" y="85" as="geometry" />
        </mxCell>
        <mxCell id="s3_2_dec2" parent="sw_backend_3_2" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Vehicle Registration Type Valid?" vertex="1">
          <mxGeometry height="120" width="140" x="930" y="70" as="geometry" />
        </mxCell>
        <mxCell id="s3_2_fail2" parent="sw_backend_3_2" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Return Not Qualified: &quot;Vehicle type must be S/D/V/I&quot;" vertex="1">
          <mxGeometry height="100" width="140" x="930" y="290" as="geometry" />
        </mxCell>
        <mxCell id="APUnelsGrHz7-8aDQZV9-6" edge="1" parent="sw_backend_3_2" source="s3_2_step3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;dashPattern=8 8;" target="APUnelsGrHz7-8aDQZV9-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_2_step3" parent="sw_backend_3_2" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Check Exemption Rules" vertex="1">
          <mxGeometry height="100" width="180" x="1150" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_2_dec3" parent="sw_backend_3_2" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Exempt?" vertex="1">
          <mxGeometry height="120" width="140" x="1390" y="70" as="geometry" />
        </mxCell>
        <mxCell id="s3_2_fail3" parent="sw_backend_3_2" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Return Not Qualified: &quot;Offence exempt from AN&quot;" vertex="1">
          <mxGeometry height="100" width="140" x="1390" y="290" as="geometry" />
        </mxCell>
        <mxCell id="s3_2_step4" parent="sw_backend_3_2" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Check Past Offence: Vehicle must have qualifying offence in past 24 months" vertex="1">
          <mxGeometry height="100" width="180" x="1660" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_2_dec4" parent="sw_backend_3_2" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Has Past Offence?" vertex="1">
          <mxGeometry height="120" width="140" x="1980" y="70" as="geometry" />
        </mxCell>
        <mxCell id="s3_2_fail4" parent="sw_backend_3_2" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Return Not Qualified: &quot;No qualifying offence in past 24 months&quot;" vertex="1">
          <mxGeometry height="100" width="140" x="1980" y="280" as="geometry" />
        </mxCell>
        <mxCell id="s3_2_query" parent="sw_backend_3_2" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=middle;rounded=0;" value="SELECT notice_no, notice_date_and_time, computer_rule_code, composition_amount&lt;br&gt;FROM ocms_valid_offence_notice&lt;br&gt;WHERE vehicle_no = [current vehicle]&lt;br&gt;&amp;nbsp;&amp;nbsp;AND notice_date_and_time &amp;gt;= [currentDate - 24 months]&lt;br&gt;&amp;nbsp;&amp;nbsp;AND notice_date_and_time &amp;lt; [currentNoticeDate]" vertex="1">
          <mxGeometry height="100" width="360" x="1570" y="230" as="geometry" />
        </mxCell>
        <mxCell id="c3_2_12" edge="1" parent="sw_backend_3_2" source="s3_2_step4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_2_query">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="APUnelsGrHz7-8aDQZV9-1" parent="sw_backend_3_2" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=middle;rounded=0;" value="Offence type must be &#39;O&#39; for AN eligibility" vertex="1">
          <mxGeometry height="60" width="130" x="245" y="230" as="geometry" />
        </mxCell>
        <mxCell id="APUnelsGrHz7-8aDQZV9-3" parent="sw_backend_3_2" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=middle;rounded=0;" value="Vehicle registration type must be:&amp;nbsp;&lt;div&gt;- S&amp;nbsp;&lt;/div&gt;&lt;div&gt;- D&amp;nbsp;&lt;/div&gt;&lt;div&gt;- V&lt;/div&gt;&lt;div&gt;- I&amp;nbsp;&lt;/div&gt;" vertex="1">
          <mxGeometry height="90" width="135" x="702.5" y="230" as="geometry" />
        </mxCell>
        <mxCell id="APUnelsGrHz7-8aDQZV9-5" parent="sw_backend_3_2" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=middle;rounded=0;" value="1. Offence code 20412 with composition amount = $80 is exempt from AN&lt;br&gt;2. Offence code 11210 with vehicle category &#39;LB&#39; (Loading Bay) or &#39;HL&#39; (Handicap Lot) is exempt from AN" vertex="1">
          <mxGeometry height="120" width="230" x="1125" y="230" as="geometry" />
        </mxCell>
        <mxCell id="s3_2_pass" parent="sw_backend_3_2" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Return Qualified: qualified=true" vertex="1">
          <mxGeometry height="100" width="140" x="2190" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_2_end" parent="sw_backend_3_2" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" value="End" vertex="1">
          <mxGeometry height="60" width="120" x="2440" y="100" as="geometry" />
        </mxCell>
        <mxCell id="c3_2_15" edge="1" parent="sw_backend_3_2" source="s3_2_pass" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_2_end">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_2_1" edge="1" parent="1" source="s3_2_start" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_2_step1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_2_2" edge="1" parent="1" source="s3_2_step1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_2_dec1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_2_3" edge="1" parent="1" source="s3_2_dec1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_2_step2" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_2_4" edge="1" parent="1" source="s3_2_dec1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_2_fail1" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_2_5" edge="1" parent="1" source="s3_2_step2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_2_dec2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_2_6" edge="1" parent="1" source="s3_2_dec2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_2_step3" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_2_7" edge="1" parent="1" source="s3_2_dec2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_2_fail2" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_2_8" edge="1" parent="1" source="s3_2_step3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_2_dec3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_2_9" edge="1" parent="1" source="s3_2_dec3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_2_fail3" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_2_10" edge="1" parent="1" source="s3_2_dec3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_2_step4" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_2_11" edge="1" parent="1" source="s3_2_step4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_2_dec4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_2_13" edge="1" parent="1" source="s3_2_dec4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_2_pass" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_2_14" edge="1" parent="1" source="s3_2_dec4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_2_fail4" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_2_16" edge="1" parent="1" source="s3_2_fail1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_2_end">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="560" y="590" />
              <mxPoint x="2520" y="590" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_2_17" edge="1" parent="1" source="s3_2_fail2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_2_end">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1020" y="590" />
              <mxPoint x="2520" y="590" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_2_18" edge="1" parent="1" source="s3_2_fail3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_2_end">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1480" y="590" />
              <mxPoint x="2520" y="590" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_2_19" edge="1" parent="1" source="s3_2_fail4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_2_end">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2070" y="590" />
              <mxPoint x="2520" y="590" />
            </Array>
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="tab3_2" name="3.2_Receive_AN_REPCCS">
    <mxGraphModel grid="1" page="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" pageScale="1" pageWidth="8000" pageHeight="2000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title_3_3" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=16;fontStyle=1" value="Section 3.2: Receive AN Data from REPCCS" vertex="1">
          <mxGeometry height="30" width="600" x="40" y="20" as="geometry" />
        </mxCell>
        <mxCell id="sw_external_3_3" parent="1" style="swimlane;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" value="REPCCS" vertex="1">
          <mxGeometry height="320" width="4250" x="20" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_ext_send" parent="sw_external_3_3" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Send Webhook Payload" vertex="1">
          <mxGeometry height="80" width="160" x="20" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_req_payload" parent="sw_external_3_3" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="POST /v1/repccsWebhook&lt;br&gt;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;transactionId&quot;: &quot;string&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;subsystemLabel&quot;: &quot;string (8)&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;anFlag&quot;: &quot;string (1)&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;noticeNo&quot;: &quot;500400058A&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;vehicleNo&quot;: &quot;string (14)&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;computerRuleCode&quot;: &quot;integer&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;compositionAmount&quot;: &quot;decimal&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;noticeDateAndTime&quot;: &quot;datetime&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;offenceNoticeType&quot;: &quot;string (1)&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;vehicleCategory&quot;: &quot;string (1)&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;vehicleRegistrationType&quot;: &quot;string (1)&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;ppCode&quot;: &quot;string (5)&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;ppName&quot;: &quot;string (100)&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;creUserId&quot;: &quot;string&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;creDate&quot;: &quot;datetime&quot;&lt;br&gt;}" vertex="1">
          <mxGeometry height="280" width="280" x="240" y="30" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_ext_recv_error" parent="sw_external_3_3" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Receive Error Response" vertex="1">
          <mxGeometry height="80" width="160" x="4070" y="190" as="geometry" />
        </mxCell>
        <mxCell id="sw_backend_3_3" parent="1" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" value="ocmsadminapi" vertex="1">
          <mxGeometry height="756" width="4250" x="20" y="394" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_start" parent="sw_backend_3_3" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" value="Start" vertex="1">
          <mxGeometry height="60" width="120" x="40" y="100" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_step1" parent="sw_backend_3_3" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Receive and parse RepWebHookPayloadDto from REPCCS webhook" vertex="1">
          <mxGeometry height="100" width="160" x="260" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_step2" parent="sw_backend_3_3" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Validate mandatory fields for REPCCS Webhook" vertex="1">
          <mxGeometry height="140" width="180" x="520" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_dec1" parent="sw_backend_3_3" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Valid Payload?" vertex="1">
          <mxGeometry height="120" width="140" x="830" y="70" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_step3" parent="sw_backend_3_3" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Check duplicate notice number" vertex="1">
          <mxGeometry height="100" width="160" x="1090" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_dec2" parent="sw_backend_3_3" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Duplicate Notice?" vertex="1">
          <mxGeometry height="120" width="140" x="1320" y="70" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_step4" parent="sw_backend_3_3" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Detect vehicle type: Apply special vehicle detection (MID/MINDEF, UNLICENSED_PARKING)" vertex="1">
          <mxGeometry height="100" width="160" x="1560" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_step5" parent="sw_backend_3_3" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Generate notice number if not provided by REPCCS" vertex="1">
          <mxGeometry height="100" width="160" x="1800" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_step6" parent="sw_backend_3_3" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Insert notice records into database tables" vertex="1">
          <mxGeometry height="100" width="160" x="2030" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_step7" parent="sw_backend_3_3" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Check double booking (Duplicate Offence)" vertex="1">
          <mxGeometry height="100" width="180" x="2270" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_dec3" parent="sw_backend_3_3" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Duplicate Offence (DBB)?" vertex="1">
          <mxGeometry height="120" width="140" x="2530" y="70" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_step8_dbb" parent="sw_backend_3_3" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Create PS-DBB suspension record, early return with success" vertex="1">
          <mxGeometry height="100" width="160" x="2520" y="280" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_dec_vip" parent="sw_backend_3_3" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Vehicle Registration Type = &#39;V&#39; (VIP)?" vertex="1">
          <mxGeometry height="120" width="140" x="2730" y="70" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_step_vip_ts_old" parent="sw_backend_3_3" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Create TS-OLD suspension: VIP vehicle must wait 21 days before AN Qualification (scheduled via CRON job)" vertex="1">
          <mxGeometry height="120" width="180" x="2710" y="280" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_insert_ts_old" parent="sw_backend_3_3" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="&lt;b&gt;INSERT ocms_suspended_notice:&lt;/b&gt;&lt;br&gt;notice_no = &#39;500400058A&#39;&lt;br&gt;date_of_suspension = GETDATE()&lt;br&gt;sr_no = NEXT VALUE FOR seq_ocms_suspended_notice_sr_no&lt;br&gt;suspension_type = &#39;TS&#39;&lt;br&gt;reason_of_suspension = &#39;OLD&#39;&lt;br&gt;suspension_source = &#39;ocmsiz_app_conn&#39;&lt;br&gt;officer_authorising_suspension = &#39;ocmsiz_app_conn&#39;&lt;br&gt;due_date_of_revival = DATEADD(day, 21, GETDATE())&lt;br&gt;cre_user_id = &#39;ocmsiz_app_conn&#39;&lt;br&gt;cre_date = GETDATE()" vertex="1">
          <mxGeometry height="170" width="350" x="2945" y="320" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_vip_ts_old_link" edge="1" parent="sw_backend_3_3" source="s3_3_step_vip_ts_old" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_3_insert_ts_old">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xJ06_9Ar7BV2rqO7vskI-2" edge="1" parent="sw_backend_3_3" source="s3_3_step9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;dashPattern=8 8;" target="xJ06_9Ar7BV2rqO7vskI-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_step9" parent="sw_backend_3_3" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Run AN qualification check" vertex="1">
          <mxGeometry height="90" width="170" x="2890" y="85" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_dec4" parent="sw_backend_3_3" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Qualifies as AN?" vertex="1">
          <mxGeometry height="120" width="140" x="3110" y="70" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_step10" parent="sw_backend_3_3" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Update AN flags: Set an_flag=&#39;Y&#39;, payment_acceptance_allowed=&#39;N&#39;" vertex="1">
          <mxGeometry height="100" width="180" x="3320" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_step11" parent="sw_backend_3_3" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Process uploaded photos/videos if present in payload" vertex="1">
          <mxGeometry height="100" width="160" x="3580" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_return_success" parent="sw_backend_3_3" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;fillColor=#fff2cc;strokeColor=#d6b656;" value="Return Success: OCMS-2000, message=&#39;OK&#39;" vertex="1">
          <mxGeometry height="100" width="160" x="3580" y="280" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_return_error" parent="sw_backend_3_3" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;fillColor=#fff2cc;strokeColor=#d6b656;" value="Return Error: OCMS-4000, message=&#39;Missing mandatory fields / Duplicate notice&#39;" vertex="1">
          <mxGeometry height="100" width="180" x="810" y="260" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_error_resp" parent="sw_backend_3_3" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="Error Response:&lt;br&gt;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;appCode&quot;: &quot;OCMS-4000&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;message&quot;: &quot;Missing mandatory fields / Duplicate notice detected&quot;&lt;br&gt;}" vertex="1">
          <mxGeometry height="100" width="370" x="390" y="320" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_query_dup" parent="sw_backend_3_3" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=middle;rounded=0;" value="SELECT&amp;nbsp;&lt;div&gt;notice_no&amp;nbsp;&lt;/div&gt;&lt;div&gt;FROM ocms_valid_offence_notice&lt;br&gt;WHERE notice_no = &#39;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;500400058A&#39;&lt;/span&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="70" width="230" x="1055" y="460" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_8" edge="1" parent="sw_backend_3_3" source="s3_3_step3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_3_query_dup">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_insert_notice" parent="sw_backend_3_3" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="&lt;b&gt;INSERT ocms_valid_offence_notice:&lt;/b&gt;&lt;br&gt;notice_no, vehicle_no, computer_rule_code, composition_amount, notice_date_and_time, offence_notice_type, vehicle_category, vehicle_registration_type, subsystem_label, pp_code, pp_name, an_flag, payment_acceptance_allowed, cre_user_id, cre_date&lt;br&gt;&lt;br&gt;&lt;b&gt;INSERT ocms_offence_notice_detail:&lt;/b&gt;&lt;br&gt;notice_no, pp_code, pp_name, iu_no, rep_obu_latitude, rep_obu_longitude, rep_operator_id, rep_parking_entry_dt, rep_parking_start_dt, rep_parking_end_dt, rep_charge_amount, rep_violation_code, other_remark, cre_user_id, cre_date&lt;br&gt;&lt;br&gt;&lt;b&gt;INSERT eocms_valid_offence_notice:&lt;/b&gt;&lt;br&gt;(mirror record for Internet zone)" vertex="1">
          <mxGeometry height="220" width="450" x="1650" y="400" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_14" edge="1" parent="sw_backend_3_3" source="s3_3_step6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_3_insert_notice">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_query_dbb" parent="sw_backend_3_3" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="&lt;b&gt;SELECT&amp;nbsp;&lt;br&gt;&lt;/b&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;von.&lt;/span&gt;notice_no,&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;von.&lt;/span&gt;vehicle_no,&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;von.&lt;/span&gt;computer_rule_code,&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;von.&lt;/span&gt;notice_date_and_time,&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;von.&lt;/span&gt;suspension_type,&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;von.&lt;/span&gt;epr_reason_of_suspension&lt;br&gt;&lt;b&gt;FROM &lt;/b&gt;ocms_valid_offence_notice &lt;b&gt;AS&lt;/b&gt; von&lt;br&gt;&lt;b&gt;WHERE&lt;/b&gt;&amp;nbsp;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;von.&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;vehicle_no = [vehicleNo]&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&amp;nbsp;AND&amp;nbsp;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;von.&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;computer_rule_code = [ruleCode]&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&amp;nbsp;AND ABS(DATEDIFF(MINUTE, notice_date_and_time, [currentNoticeDateTime])) &amp;lt;= 15&lt;/div&gt;" vertex="1">
          <mxGeometry height="180" width="310" x="2205" y="220" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_16" edge="1" parent="sw_backend_3_3" source="s3_3_step7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_3_query_dbb">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_insert_dbb" parent="sw_backend_3_3" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="&lt;b&gt;INSERT ocms_suspended_notice:&lt;/b&gt;&lt;br&gt;notice_no = &#39;500400058A&#39;&lt;br&gt;date_of_suspension = GETDATE()&lt;br&gt;sr_no = NEXT VALUE FOR seq_ocms_suspended_notice_sr_no&lt;br&gt;suspension_type = &#39;PS&#39;&lt;br&gt;reason_of_suspension = &#39;DBB&#39;&lt;br&gt;suspension_source = &#39;ocmsiz_app_conn&#39;&lt;br&gt;officer_authorising_suspension = &#39;ocmsiz_app_conn&#39;&lt;br&gt;cre_user_id = &#39;ocmsiz_app_conn&#39;&lt;br&gt;cre_date = GETDATE()" vertex="1">
          <mxGeometry height="170" width="350" x="2220" y="436" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_20" edge="1" parent="sw_backend_3_3" source="s3_3_step8_dbb" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_3_insert_dbb">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_update_an" parent="sw_backend_3_3" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="UPDATE ocms_valid_offence_notice&lt;br&gt;SET&amp;nbsp;&lt;div&gt;an_flag=&#39;Y&#39;,&amp;nbsp;&lt;/div&gt;&lt;div&gt;payment_acceptance_allowed=&#39;N&#39;&lt;br&gt;WHERE notice_no = &#39;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;500400058A&#39;&lt;/span&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="90" width="230" x="3295" y="210" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_25" edge="1" parent="sw_backend_3_3" source="s3_3_step10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_3_update_an">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xJ06_9Ar7BV2rqO7vskI-1" parent="sw_backend_3_3" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=middle;rounded=0;autosize=1;resizable=0;" value="offence_notice_type=&#39;O&#39;&lt;div&gt;vehicle_registration_type in [S,D,V,I]&lt;/div&gt;" vertex="1">
          <mxGeometry height="40" width="220" x="2865" y="220" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_ext_recv_success" parent="sw_backend_3_3" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Receive Success Response" vertex="1">
          <mxGeometry height="80" width="160" x="3850" y="-234" as="geometry" />
        </mxCell>
        <mxCell id="s3_3_success_resp" parent="sw_backend_3_3" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="Success Response:&lt;br&gt;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;appCode&quot;: &quot;OCMS-2000&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;message&quot;: &quot;OK&quot;&lt;br&gt;}" vertex="1">
          <mxGeometry height="100" width="220" x="3790" y="60" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_32" edge="1" parent="sw_backend_3_3" source="s3_3_success_resp" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_ext_recv_success">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_1" edge="1" parent="1" source="s3_3_ext_send" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_start">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_2" edge="1" parent="1" source="s3_3_ext_send" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_3_req_payload">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_3" edge="1" parent="1" source="s3_3_start" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_step1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_4" edge="1" parent="1" source="s3_3_step1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_step2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_5" edge="1" parent="1" source="s3_3_step2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_dec1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_6" edge="1" parent="1" source="s3_3_dec1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_step3" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_7" edge="1" parent="1" source="s3_3_dec1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_return_error" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_9" edge="1" parent="1" source="s3_3_step3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_dec2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_10" edge="1" parent="1" source="s3_3_dec2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;jumpStyle=arc;" target="s3_3_return_error" value="yes">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1410" y="690" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_3_11" edge="1" parent="1" source="s3_3_dec2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_step4" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_12" edge="1" parent="1" source="s3_3_step4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_step5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_13" edge="1" parent="1" source="s3_3_step5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_step6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_15" edge="1" parent="1" source="s3_3_step6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_step7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_17" edge="1" parent="1" source="s3_3_step7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_dec3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_18" edge="1" parent="1" source="s3_3_dec3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_step8_dbb" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_19" edge="1" parent="1" source="s3_3_dec3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_dec_vip" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_21" edge="1" parent="1" source="s3_3_step8_dbb" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;jumpStyle=arc;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="s3_3_return_success">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2620" y="1000" />
              <mxPoint x="3560" y="1000" />
              <mxPoint x="3560" y="724" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_3_vip_yes" edge="1" parent="1" source="s3_3_dec_vip" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_step_vip_ts_old" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_vip_no" edge="1" parent="1" source="s3_3_dec_vip" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;" target="s3_3_step9" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_vip_to_success" edge="1" parent="1" source="s3_3_step_vip_ts_old" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;jumpStyle=arc;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="s3_3_return_success">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2820" y="1000" />
              <mxPoint x="3560" y="1000" />
              <mxPoint x="3560" y="724" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_3_22" edge="1" parent="1" source="s3_3_step9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_dec4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_23" edge="1" parent="1" source="s3_3_dec4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_step10" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_24" edge="1" parent="1" source="s3_3_dec4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_step11" value="no">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3200" y="420" />
              <mxPoint x="3680" y="420" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_3_26" edge="1" parent="1" source="s3_3_step10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_step11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_27" edge="1" parent="1" source="s3_3_step11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_3_return_success">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_28" edge="1" parent="1" source="s3_3_return_success" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_3_success_resp">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_29" edge="1" parent="1" source="s3_3_return_error" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_3_error_resp">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_3_33" edge="1" parent="1" source="s3_3_error_resp" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;jumpStyle=arc;" target="s3_3_ext_recv_error">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="595" y="1040" />
              <mxPoint x="4180" y="1040" />
            </Array>
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="tab3_3" name="3.3_Receive_AN_CES">
    <mxGraphModel dx="1033" dy="605" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="8500" pageHeight="2000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title_3_4" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=16;fontStyle=1" value="Section 3.3: Receive AN Data from CES" vertex="1">
          <mxGeometry height="30" width="600" x="40" y="20" as="geometry" />
        </mxCell>
        <mxCell id="sw_external_3_4" parent="1" style="swimlane;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" value="External System (CES)" vertex="1">
          <mxGeometry height="310" width="5080" x="20" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_ext_send" parent="sw_external_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Send Webhook Payload" vertex="1">
          <mxGeometry height="80" width="160" x="40" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_req_payload" parent="sw_external_3_4" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="POST /v1/cesWebhook-create-notice&lt;br&gt;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;transactionId&quot;: &quot;string&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;subsystemLabel&quot;: &quot;string (3-8, 030-999)&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;anFlag&quot;: &quot;string (1)&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;noticeNo&quot;: &quot;500400058A&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;vehicleNo&quot;: &quot;string (14)&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;computerRuleCode&quot;: &quot;integer&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;compositionAmount&quot;: &quot;decimal&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;noticeDateAndTime&quot;: &quot;datetime&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;offenceNoticeType&quot;: &quot;string (1)&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;vehicleCategory&quot;: &quot;string (1)&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;vehicleRegistrationType&quot;: &quot;string (1)&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;ppCode&quot;: &quot;string (5)&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;ppName&quot;: &quot;string (100)&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;creUserId&quot;: &quot;string&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;creDate&quot;: &quot;datetime&quot;&lt;br&gt;}" vertex="1">
          <mxGeometry height="270" width="320" x="260" y="30" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_ext_recv_error" parent="sw_external_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Receive Error Response" vertex="1">
          <mxGeometry height="80" width="160" x="4900" y="190" as="geometry" />
        </mxCell>
        <mxCell id="sw_backend_3_4" parent="1" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" value="Backend (OCMS API)" vertex="1">
          <mxGeometry height="900" width="5080" x="20" y="380" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_start" parent="sw_backend_3_4" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" value="Start" vertex="1">
          <mxGeometry height="60" width="120" x="60" y="100" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_step1" parent="sw_backend_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Receive CesCreateNoticeDto from CES webhook" vertex="1">
          <mxGeometry height="100" width="160" x="220" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_step2" parent="sw_backend_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Validate mandatory fields for CES Webhook" vertex="1">
          <mxGeometry height="110" width="200" x="450" y="75" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_dec1" parent="sw_backend_3_4" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Valid Payload?" vertex="1">
          <mxGeometry height="120" width="140" x="720" y="70" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_step3" parent="sw_backend_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Validate subsystem label" vertex="1">
          <mxGeometry height="110" width="190" x="960" y="75" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_dec2" parent="sw_backend_3_4" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Valid Subsystem?" vertex="1">
          <mxGeometry height="120" width="140" x="1300" y="70" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_step4" parent="sw_backend_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Check duplicate notice number" vertex="1">
          <mxGeometry height="100" width="160" x="1510" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_dec3" parent="sw_backend_3_4" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Duplicate Notice?" vertex="1">
          <mxGeometry height="120" width="140" x="1780" y="70" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_step5" parent="sw_backend_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Validate offence rule code" vertex="1">
          <mxGeometry height="90" width="170" x="2000" y="85" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_dec4" parent="sw_backend_3_4" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Valid Rule Code?" vertex="1">
          <mxGeometry height="120" width="140" x="2260" y="70" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_step6" parent="sw_backend_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Detect vehicle type: Apply special vehicle detection" vertex="1">
          <mxGeometry height="100" width="160" x="2480" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_step7" parent="sw_backend_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Check CES AN Flag" vertex="1">
          <mxGeometry height="100" width="170" x="2720" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_dec5" parent="sw_backend_3_4" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="an_flag=&#39;Y&#39;?" vertex="1">
          <mxGeometry height="120" width="140" x="2960" y="70" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_step8_ans" parent="sw_backend_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Create PS-ANS suspension: Insert notice records and create immediate suspension, early return with success" vertex="1">
          <mxGeometry height="120" width="160" x="2950" y="250" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_step9" parent="sw_backend_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Insert notice records" vertex="1">
          <mxGeometry height="100" width="180" x="3190" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_step10" parent="sw_backend_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Check double booking" vertex="1">
          <mxGeometry height="100" width="180" x="3490" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_dec6" parent="sw_backend_3_4" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Duplicate Offence?" vertex="1">
          <mxGeometry height="120" width="140" x="3820" y="70" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_step11_dbb" parent="sw_backend_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Create PS-DBB suspension record, early return with success" vertex="1">
          <mxGeometry height="100" width="160" x="3810" y="280" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_step12" parent="sw_backend_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Continue as standard Type O notice processing" vertex="1">
          <mxGeometry height="100" width="160" x="4040" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_step14" parent="sw_backend_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Process uploaded photos/videos if present in payload" vertex="1">
          <mxGeometry height="100" width="160" x="4390" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_return_success" parent="sw_backend_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;fillColor=#fff2cc;strokeColor=#d6b656;" value="Return Success: OCMS-2000, message=&#39;Resource created successfully&#39;" vertex="1">
          <mxGeometry height="100" width="160" x="4390" y="410" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_return_error1" parent="sw_backend_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;fillColor=#fff2cc;strokeColor=#d6b656;" value="Return Error: OCMS-4000, message=&#39;Validation error&#39;" vertex="1">
          <mxGeometry height="100" width="160" x="900" y="500" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_error_resp1" parent="sw_backend_3_4" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="Error Response (validation):&lt;br&gt;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;appCode&quot;: &quot;OCMS-4000&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;message&quot;: &quot;subsystemlabel Length &amp;lt; 3 / subsystemlabel Length &amp;gt; 8 / subsystemlabel Not in Range 030-999&quot;&lt;br&gt;}" vertex="1">
          <mxGeometry height="100" width="350" x="240" y="500" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_40" edge="1" parent="sw_backend_3_4" source="s3_4_return_error1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" target="s3_4_error_resp1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_return_error2" parent="sw_backend_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;fillColor=#fff2cc;strokeColor=#d6b656;" value="Return Error: HTTP 226 IM Used, OCMS-2026, message=&#39;Notice already exists / Invalid Rule Code&#39;" vertex="1">
          <mxGeometry height="120" width="180" x="1940" y="360" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_error_resp2" parent="sw_backend_3_4" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="Error Response (duplicate/rule):&lt;br&gt;HTTP Status: 226 IM Used&lt;br&gt;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;data&quot;: {&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;appCode&quot;: &quot;OCMS-2026&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;message&quot;: &quot;Notice no Already exists / Invalid Offence Rule Code&quot;&lt;br&gt;&amp;nbsp;&amp;nbsp;}&lt;br&gt;}" vertex="1">
          <mxGeometry height="140" width="350" x="1400" y="350" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_41" edge="1" parent="sw_backend_3_4" source="s3_4_return_error2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;entryX=1;entryY=0.5;entryDx=0;entryDy=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" target="s3_4_error_resp2">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1850" y="420" />
              <mxPoint x="1850" y="420" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="s3_4_query_dup" parent="sw_backend_3_4" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=middle;rounded=0;" value="SELECT&amp;nbsp;&lt;div&gt;notice_no&amp;nbsp;&lt;/div&gt;&lt;div&gt;FROM ocms_valid_offence_notice&lt;br&gt;WHERE notice_no = &#39;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;500400058A&#39;&lt;/span&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="80" width="190" x="1495" y="230" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_11" edge="1" parent="sw_backend_3_4" source="s3_4_step4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_4_query_dup">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_query_rule" parent="sw_backend_3_4" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=middle;rounded=0;" value="SELECT&amp;nbsp;&lt;div&gt;rule_code&amp;nbsp;&lt;/div&gt;&lt;div&gt;FROM ocms_offence_rule_code&lt;br&gt;WHERE rule_code = [computerRuleCode]&lt;/div&gt;" vertex="1">
          <mxGeometry height="70" width="240" x="1965" y="240" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_15" edge="1" parent="sw_backend_3_4" source="s3_4_step5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_4_query_rule">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_insert_ans" parent="sw_backend_3_4" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="&lt;b&gt;INSERT ocms_suspended_notice:&lt;/b&gt;&lt;br&gt;notice_no = &#39;500400058A&#39;&lt;br&gt;date_of_suspension = GETDATE()&lt;br&gt;sr_no = NEXT VALUE FOR seq_ocms_suspended_notice_sr_no&lt;br&gt;suspension_type = &#39;PS&#39;&lt;br&gt;reason_of_suspension = &#39;ANS&#39;&lt;br&gt;suspension_source = &#39;ocmsiz_app_conn&#39;&lt;br&gt;officer_authorising_suspension = &#39;ocmsiz_app_conn&#39;&lt;br&gt;cre_user_id = &#39;ocmsiz_app_conn&#39;&lt;br&gt;cre_date = GETDATE()" vertex="1">
          <mxGeometry height="170" width="350" x="2550" y="225" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_23" edge="1" parent="sw_backend_3_4" source="s3_4_step8_ans" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_4_insert_ans">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_insert_notice" parent="sw_backend_3_4" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="&lt;b&gt;INSERT ocms_valid_offence_notice:&lt;/b&gt;&lt;br&gt;notice_no,&amp;nbsp;&lt;div&gt;vehicle_no,&amp;nbsp;&lt;/div&gt;&lt;div&gt;computer_rule_code,&amp;nbsp;&lt;/div&gt;&lt;div&gt;composition_amount,&amp;nbsp;&lt;/div&gt;&lt;div&gt;notice_date_and_time,&amp;nbsp;&lt;/div&gt;&lt;div&gt;offence_notice_type,&amp;nbsp;&lt;/div&gt;&lt;div&gt;vehicle_category,&amp;nbsp;&lt;/div&gt;&lt;div&gt;vehicle_registration_type,&amp;nbsp;&lt;/div&gt;&lt;div&gt;subsystem_label,&amp;nbsp;&lt;/div&gt;&lt;div&gt;pp_code,&lt;/div&gt;&lt;div&gt;pp_name,&amp;nbsp;&lt;/div&gt;&lt;div&gt;an_flag,&amp;nbsp;&lt;/div&gt;&lt;div&gt;payment_acceptance_allowed,&amp;nbsp;&lt;/div&gt;&lt;div&gt;cre_user_id,&amp;nbsp;&lt;/div&gt;&lt;div&gt;cre_date&lt;br&gt;&lt;br&gt;&lt;b&gt;INSERT ocms_offence_notice_detail:&lt;/b&gt;&lt;br&gt;notice_no,&amp;nbsp;&lt;div&gt;pp_code,&amp;nbsp;&lt;/div&gt;&lt;div&gt;pp_name,&amp;nbsp;&lt;/div&gt;&lt;div&gt;cre_user_id,&amp;nbsp;&lt;/div&gt;&lt;div&gt;cre_date&lt;br&gt;&lt;br&gt;&lt;b&gt;INSERT eocms_valid_offence_notice:&lt;/b&gt;&lt;br&gt;(same record for Internet zone)&lt;/div&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="390" width="230" x="3165" y="210" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_25" edge="1" parent="sw_backend_3_4" source="s3_4_step9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_4_insert_notice">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_query_dbb" parent="sw_backend_3_4" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="&lt;b&gt;SELECT&amp;nbsp;&lt;/b&gt;&lt;div&gt;von.notice_no,&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;von.&lt;/span&gt;vehicle_no,&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;von.&lt;/span&gt;computer_rule_code,&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;von.&lt;/span&gt;notice_date_and_time,&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;von.&lt;/span&gt;suspension_type,&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;von.&lt;/span&gt;epr_reason_of_suspension&lt;br&gt;&lt;b&gt;FROM &lt;/b&gt;ocms_valid_offence_notice &lt;b&gt;AS &lt;/b&gt;von&lt;br&gt;&lt;b&gt;WHERE&amp;nbsp;&lt;/b&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;von.&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;vehicle_no = [vehicleNo]&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&amp;nbsp;&lt;b&gt;AND&amp;nbsp;&lt;/b&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;von.&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;computer_rule_code = [ruleCode]&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&amp;nbsp;&lt;b&gt;AND &lt;/b&gt;ABS(DATEDIFF(MINUTE, notice_date_and_time, [currentNoticeDateTime])) &amp;lt;= 15&lt;/div&gt;" vertex="1">
          <mxGeometry height="185" width="310" x="3425" y="220" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_27" edge="1" parent="sw_backend_3_4" source="s3_4_step10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_4_query_dbb">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_insert_dbb" parent="sw_backend_3_4" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="&lt;b&gt;INSERT ocms_suspended_notice:&lt;/b&gt;&lt;br&gt;notice_no = &#39;500400058A&#39;&lt;div&gt;date_of_suspension = GETDATE()&lt;br&gt;sr_no = NEXT VALUE FOR seq_ocms_suspended_notice_sr_no&lt;br&gt;suspension_type = &#39;PS&#39;&lt;br&gt;reason_of_suspension = &#39;DBB&#39;&lt;br&gt;suspension_source = &#39;ocmsiz_app_conn&#39;&lt;br&gt;officer_authorising_suspension = &#39;ocmsiz_app_conn&#39;&lt;br&gt;cre_user_id = &#39;ocmsiz_app_conn&#39;&lt;br&gt;cre_date = GETDATE()&lt;/div&gt;" vertex="1">
          <mxGeometry height="160" width="350" x="4015" y="250" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_31" edge="1" parent="sw_backend_3_4" source="s3_4_step11_dbb" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_4_insert_dbb">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="iL3DrdXzqOuvDi-Js8zM-1" parent="sw_backend_3_4" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;autosize=1;resizable=0;" value="(CES source - AN flag already set from payload, no AN verification required)" vertex="1">
          <mxGeometry height="30" width="430" x="3905" y="45" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_33" edge="1" parent="sw_backend_3_4" source="s3_4_step12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="s3_4_step14">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="4320" y="130" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="s3_4_ext_recv_success" parent="sw_backend_3_4" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Receive Success Response" vertex="1">
          <mxGeometry height="80" width="160" x="4660" y="-170" as="geometry" />
        </mxCell>
        <mxCell id="s3_4_success_resp" parent="sw_backend_3_4" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="Success Response:&lt;br&gt;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;appCode&quot;: &quot;OCMS-2000&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;message&quot;: &quot;Resource created successfully&quot;&lt;br&gt;}" vertex="1">
          <mxGeometry height="100" width="280" x="4580" y="60" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_45" edge="1" parent="sw_backend_3_4" source="s3_4_success_resp" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_ext_recv_success">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_1" edge="1" parent="1" source="s3_4_ext_send" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_start">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_2" edge="1" parent="1" source="s3_4_ext_send" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_4_req_payload">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_3" edge="1" parent="1" source="s3_4_start" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_step1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_4" edge="1" parent="1" source="s3_4_step1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_step2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_5" edge="1" parent="1" source="s3_4_step2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_dec1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_6" edge="1" parent="1" source="s3_4_dec1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_step3" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_7" edge="1" parent="1" source="s3_4_dec1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="s3_4_return_error1" value="no">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="810" y="810" />
              <mxPoint x="1000" y="810" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_4_8" edge="1" parent="1" source="s3_4_step3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_dec2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_9" edge="1" parent="1" source="s3_4_dec2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_step4" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_10" edge="1" parent="1" source="s3_4_dec2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="s3_4_return_error1" value="no">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1390" y="810" />
              <mxPoint x="1000" y="810" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_4_12" edge="1" parent="1" source="s3_4_step4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_dec3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_13" edge="1" parent="1" source="s3_4_dec3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;" value="yes">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1870" y="710" />
              <mxPoint x="2050" y="710" />
            </Array>
            <mxPoint x="2050" y="740" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_4_14" edge="1" parent="1" source="s3_4_dec3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_step5" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_16" edge="1" parent="1" source="s3_4_step5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_dec4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_17" edge="1" parent="1" source="s3_4_dec4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_step6" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_18" edge="1" parent="1" source="s3_4_dec4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.996;entryY=0.606;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;jumpStyle=arc;" target="s3_4_return_error2" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_19" edge="1" parent="1" source="s3_4_step6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_step7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_20" edge="1" parent="1" source="s3_4_step7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_dec5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_21" edge="1" parent="1" source="s3_4_dec5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_step8_ans" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_22" edge="1" parent="1" source="s3_4_dec5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_step9" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_24" edge="1" parent="1" source="s3_4_step8_ans" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;jumpStyle=arc;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" target="s3_4_return_success">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3050" y="1130" />
              <mxPoint x="4490" y="1130" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_4_26" edge="1" parent="1" source="s3_4_step9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_step10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_28" edge="1" parent="1" source="s3_4_step10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_dec6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_29" edge="1" parent="1" source="s3_4_dec6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_step11_dbb" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_30" edge="1" parent="1" source="s3_4_dec6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_step12" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_32" edge="1" parent="1" source="s3_4_step11_dbb" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="s3_4_return_success">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3910" y="840" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_4_38" edge="1" parent="1" source="s3_4_step14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_return_success">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_39" edge="1" parent="1" source="s3_4_return_success" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_4_success_resp">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_4_46" edge="1" parent="1" source="s3_4_error_resp1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_ext_recv_error">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="550" y="1210" />
              <mxPoint x="5000" y="1210" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_4_47" edge="1" parent="1" source="s3_4_error_resp2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_4_ext_recv_error">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1580" y="1210" />
              <mxPoint x="5000" y="1210" />
            </Array>
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="tab3_4" name="3.4_Retrieve_Owner_Particulars">
    <mxGraphModel dx="5507" dy="3227" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="8000" pageHeight="2000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title_tab3_5" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=16;fontStyle=1" value="Section 3.4: Retrieve Vehicle Owner Particulars (LTA + DataHive/MHA)" vertex="1">
          <mxGeometry height="30" width="600" x="40" y="20" as="geometry" />
        </mxCell>
        <mxCell id="sw_backend_3_5" parent="1" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" value="ocmsadminapi" vertex="1">
          <mxGeometry height="760" width="3630" x="20" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_start" parent="sw_backend_3_5" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" value="Start" vertex="1">
          <mxGeometry height="60" width="120" x="40" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_step1" parent="sw_backend_3_5" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Check vehicle registration type" vertex="1">
          <mxGeometry height="80" width="160" x="220" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_dec1" parent="sw_backend_3_5" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Military Vehicle? (vehicle_registration_type = &#39;I&#39;)" vertex="1">
          <mxGeometry height="100" width="140" x="440" y="40" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_step2_military" parent="sw_backend_3_5" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Set Military Owner: owner = MINDEF, skip LTA API call" vertex="1">
          <mxGeometry height="80" width="160" x="430" y="220" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_step3" parent="sw_backend_3_5" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Call LTA API to get vehicle owner particulars" vertex="1">
          <mxGeometry height="80" width="160" x="640" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_dec2" parent="sw_backend_3_5" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="LTA Success?" vertex="1">
          <mxGeometry height="100" width="140" x="860" y="40" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_manual1" parent="sw_backend_3_5" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Manual Review Queue" vertex="1">
          <mxGeometry height="60" width="160" x="850" y="220" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_step4" parent="sw_backend_3_5" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Store Owner Details: Save vehicle owner name, NRIC/FIN, registration details" vertex="1">
          <mxGeometry height="80" width="180" x="1060" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_step5" parent="sw_backend_3_5" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Check if notice is suspended" vertex="1">
          <mxGeometry height="80" width="180" x="1300" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_dec3" parent="sw_backend_3_5" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Notice Suspended? (suspension_type != NULL)" vertex="1">
          <mxGeometry height="100" width="140" x="1540" y="40" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_skip" parent="sw_backend_3_5" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Skip Notification: Do not send notification for suspended notice" vertex="1">
          <mxGeometry height="80" width="160" x="1530" y="220" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_step6" parent="sw_backend_3_5" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Check if owner is in eNotification exclusion list" vertex="1">
          <mxGeometry height="80" width="180" x="1740" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_dec4" parent="sw_backend_3_5" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="In Exclusion List?" vertex="1">
          <mxGeometry height="100" width="140" x="1980" y="40" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_step7_datahive" parent="sw_backend_3_5" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Call DataHive API to get mobile/email" vertex="1">
          <mxGeometry height="80" width="160" x="2180" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_step8_ean" parent="sw_backend_3_5" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Qualify for eAN: Set eAN eligible flag" vertex="1">
          <mxGeometry height="80" width="160" x="2430" y="230" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_step9_mha" parent="sw_backend_3_5" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Call MHA API to get registered address" vertex="1">
          <mxGeometry height="80" width="160" x="2700" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_dec6" parent="sw_backend_3_5" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Address Found?" vertex="1">
          <mxGeometry height="100" width="140" x="2980" y="40" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_step10_letter" parent="sw_backend_3_5" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Qualify for AN Letter: Set AN letter flag" vertex="1">
          <mxGeometry height="80" width="160" x="3240" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_manual2" parent="sw_backend_3_5" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Manual Review Queue" vertex="1">
          <mxGeometry height="60" width="160" x="2970" y="220" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_end" parent="sw_backend_3_5" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" value="End" vertex="1">
          <mxGeometry height="60" width="120" x="3460" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_check_exclusion" parent="sw_backend_3_5" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=middle;rounded=0;" value="SELECT&amp;nbsp;&lt;div&gt;id_no&amp;nbsp;&lt;/div&gt;&lt;div&gt;FROM ocms_enotification_exclusion_list&lt;br&gt;WHERE id_no = &#39;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;S1234567A&#39;&lt;/span&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="80" width="220" x="1720" y="170" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_16" edge="1" parent="sw_backend_3_5" source="s3_5_step6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_5_check_exclusion">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_api_lta" parent="sw_backend_3_5" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="LTA API:&lt;br&gt;&lt;br&gt;GET LTA_API/vehicle/owner?vehicleNo=[vehicle_number]&lt;br&gt;Headers:&lt;br&gt;&amp;nbsp;&amp;nbsp;API-Key: [from Azure Key Vault]&lt;br&gt;&lt;br&gt;&lt;b&gt;Success Response (200):&lt;/b&gt;&lt;br&gt;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;ownerName&quot;: &quot;TAN AH KOW&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;ownerNRIC&quot;: &quot;S1234567A&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;vehicleMake&quot;: &quot;TOYOTA&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;vehicleModel&quot;: &quot;CAMRY&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;roadTaxExpiry&quot;: &quot;2026-12-31&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;diplomaticFlag&quot;: false&lt;br&gt;}&lt;br&gt;&lt;br&gt;&lt;b&gt;Error Response (4xx/5xx):&lt;/b&gt;&lt;br&gt;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;errorCode&quot;: &quot;LTA-404&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;message&quot;: &quot;Vehicle not found&quot;&lt;br&gt;}&lt;br&gt;&lt;br&gt;Timeout: 30 seconds&lt;br&gt;Retry: 3 attempts (backoff: 100ms, 200ms, 400ms)&lt;br&gt;On failure: Send email alert to admin, add to manual queue" vertex="1">
          <mxGeometry height="370" width="360" x="540" y="350" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_5" edge="1" parent="sw_backend_3_5" source="s3_5_step3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_5_api_lta">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_check_suspension" parent="sw_backend_3_5" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=middle;rounded=0;" value="SELECT&amp;nbsp;&lt;div&gt;sn.suspension_type&amp;nbsp;&lt;/div&gt;&lt;div&gt;FROM ocms_suspended_notice AS sn&lt;br&gt;WHERE sn.notice_no = &#39;500400058A&#39;&lt;br&gt;AND sn.suspension_type IS NOT NULL&lt;/div&gt;" vertex="1">
          <mxGeometry height="90" width="220" x="1280" y="170" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_12" edge="1" parent="sw_backend_3_5" source="s3_5_step5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_5_check_suspension">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_api_datahive" parent="sw_backend_3_5" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="DataHive API:&lt;br&gt;&lt;br&gt;GET DATAHIVE_API/contact?nric=[owner_nric]&lt;br&gt;Headers:&lt;br&gt;&amp;nbsp;&amp;nbsp;API-Key: [from Azure Key Vault]&lt;br&gt;&lt;br&gt;Response:&lt;br&gt;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;mobileNumber&quot;: &quot;string&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;emailAddress&quot;: &quot;string&quot;&lt;br&gt;}&lt;br&gt;&lt;br&gt;Timeout: 30 seconds&lt;br&gt;Retry: 3 attempts (backoff: 100ms, 200ms, 400ms)&lt;br&gt;On failure: Send email alert to admin, add to manual queue" vertex="1">
          <mxGeometry height="230" width="330" x="2095" y="170" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_20" edge="1" parent="sw_backend_3_5" source="s3_5_step7_datahive" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_5_api_datahive">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_api_mha" parent="sw_backend_3_5" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="MHA API:&lt;br&gt;&lt;br&gt;GET MHA_API/address?nric=S1234567A&lt;br&gt;Headers:&lt;br&gt;&amp;nbsp;&amp;nbsp;API-Key: [from Azure Key Vault]&lt;br&gt;&lt;br&gt;Response:&lt;br&gt;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;buildingName&quot;: &quot;string&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;streetName&quot;: &quot;string&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;postalCode&quot;: &quot;string&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;unitNumber&quot;: &quot;string&quot;&lt;br&gt;}&lt;br&gt;&lt;br&gt;Timeout: 30 seconds&lt;br&gt;Retry: 3 attempts (backoff: 100ms, 200ms, 400ms)&lt;br&gt;On failure: Send email alert to admin, add to manual queue" vertex="1">
          <mxGeometry height="260" width="330" x="2615" y="180" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_25" edge="1" parent="sw_backend_3_5" source="s3_5_step9_mha" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_5_api_mha">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_store_owner" parent="sw_backend_3_5" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="&lt;b&gt;INSERT ocms_offence_notice_owner_driver:&lt;/b&gt;&lt;br&gt;notice_no =&#39;500400058A&#39;&lt;br&gt;owner_driver_indicator = &#39;O&#39;&lt;br&gt;owner_id_type = [idType]&lt;br&gt;owner_nric_no = [ownerNric]&lt;br&gt;owner_name = [ownerName]&lt;br&gt;owner_blk_hse_no = [blkHseNo]&lt;br&gt;owner_street = [street]&lt;br&gt;owner_floor = [floor]&lt;br&gt;owner_unit = [unit]&lt;br&gt;owner_bldg = [bldg]&lt;br&gt;owner_postal_code = [postalCode]&lt;br&gt;cre_date = CURRENT_TIMESTAMP&lt;br&gt;cre_user_id = &#39;ocmsiz_app_conn&#39;" vertex="1">
          <mxGeometry height="230" width="300" x="1046" y="360" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_10" edge="1" parent="sw_backend_3_5" source="s3_5_step4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;exitX=0.75;exitY=1;exitDx=0;exitDy=0;" target="s3_5_store_owner">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_5_dec5" parent="sw_backend_3_5" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Contact Found? (mobile OR email)" vertex="1">
          <mxGeometry height="100" width="140" x="2440" y="40" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_22" edge="1" parent="sw_backend_3_5" source="s3_5_dec5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" value="yes">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2510" y="230" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_5_1" edge="1" parent="1" source="s3_5_start" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_step1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_2" edge="1" parent="1" source="s3_5_step1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_dec1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_3" edge="1" parent="1" source="s3_5_dec1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_step2_military" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_4" edge="1" parent="1" source="s3_5_dec1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_step3" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_6" edge="1" parent="1" source="s3_5_step3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_dec2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_7" edge="1" parent="1" source="s3_5_dec2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_step4" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_8" edge="1" parent="1" source="s3_5_dec2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_manual1" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_9" edge="1" parent="1" source="s3_5_step2_military" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_step4">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="530" y="420" />
              <mxPoint x="1170" y="420" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_5_11" edge="1" parent="1" source="s3_5_step4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_step5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_13" edge="1" parent="1" source="s3_5_step5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_dec3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_14" edge="1" parent="1" source="s3_5_dec3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_skip" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_15" edge="1" parent="1" source="s3_5_dec3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_step6" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_17" edge="1" parent="1" source="s3_5_step6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_dec4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_18" edge="1" parent="1" source="s3_5_dec4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_step9_mha" value="yes">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2070" y="110" />
              <mxPoint x="2810" y="110" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_5_19" edge="1" parent="1" source="s3_5_dec4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_step7_datahive" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_21" edge="1" parent="1" source="s3_5_step7_datahive" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_dec5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_23" edge="1" parent="1" source="s3_5_dec5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;" target="s3_5_step9_mha" value="no">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2760" y="170" />
              <mxPoint x="2760" y="170" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_5_24" edge="1" parent="1" source="s3_5_step8_ean" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" target="s3_5_end">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2530" y="540" />
              <mxPoint x="3540" y="540" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_5_26" edge="1" parent="1" source="s3_5_step9_mha" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_dec6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_27" edge="1" parent="1" source="s3_5_dec6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_step10_letter" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_28" edge="1" parent="1" source="s3_5_dec6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_manual2" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_29" edge="1" parent="1" source="s3_5_step10_letter" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_end">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_5_30" edge="1" parent="1" source="s3_5_manual1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_end">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="950" y="700" />
              <mxPoint x="3540" y="700" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_5_31" edge="1" parent="1" source="s3_5_skip" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_5_end">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1630" y="540" />
              <mxPoint x="3540" y="540" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_5_32" edge="1" parent="1" source="s3_5_manual2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" target="s3_5_end">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3540" y="330" />
            </Array>
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="tab3_5" name="3.5_Send_eNotification">
    <mxGraphModel dx="2753" dy="1613" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="8000" pageHeight="2000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title_tab3_6" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=16;fontStyle=1" value="Section 3.5: Send eNotification (eAN)" vertex="1">
          <mxGeometry height="30" width="600" x="40" y="20" as="geometry" />
        </mxCell>
        <mxCell id="sw_backend_3_6" parent="1" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" value="Backend (OCMS API)" vertex="1">
          <mxGeometry height="680" width="3770" x="20" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_start" parent="sw_backend_3_6" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" value="Start" vertex="1">
          <mxGeometry height="60" width="120" x="40" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_step1" parent="sw_backend_3_6" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Retrieve Notice Details" vertex="1">
          <mxGeometry height="80" width="160" x="220" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_step2" parent="sw_backend_3_6" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Retrieve Owner Contact" vertex="1">
          <mxGeometry height="80" width="160" x="440" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_step3" parent="sw_backend_3_6" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Generate eAN Content" vertex="1">
          <mxGeometry height="80" width="160" x="660" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_dec1" parent="sw_backend_3_6" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Mobile Available?" vertex="1">
          <mxGeometry height="100" width="140" x="880" y="40" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_step4" parent="sw_backend_3_6" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Send SMS: Call SMS Gateway API to send eAN SMS" vertex="1">
          <mxGeometry height="80" width="160" x="1080" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_step5" parent="sw_backend_3_6" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Log SMS Sent: Log SMS status, timestamp, recipient" vertex="1">
          <mxGeometry height="80" width="160" x="1300" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_dec2" parent="sw_backend_3_6" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="SMS Success?" vertex="1">
          <mxGeometry height="100" width="140" x="1520" y="40" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_dec3" parent="sw_backend_3_6" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Email Available?" vertex="1">
          <mxGeometry height="100" width="140" x="1740" y="40" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_step7" parent="sw_backend_3_6" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Send Email: Call Email Service API to send eAN email" vertex="1">
          <mxGeometry height="80" width="160" x="1940" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_step8" parent="sw_backend_3_6" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Log Email Sent: Log email status, timestamp, recipient" vertex="1">
          <mxGeometry height="80" width="160" x="2160" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_dec4" parent="sw_backend_3_6" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Email Success?" vertex="1">
          <mxGeometry height="100" width="140" x="2380" y="40" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_step10" parent="sw_backend_3_6" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Update eAN Status: Set eAN_sent_flag=&#39;Y&#39;, sent timestamp, notification method" vertex="1">
          <mxGeometry height="80" width="180" x="2600" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_step11" parent="sw_backend_3_6" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Log Notification Complete: Log eAN notification completion" vertex="1">
          <mxGeometry height="80" width="160" x="2840" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_fallback" parent="sw_backend_3_6" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Fallback to Letter: If all retries fail, send email alert to admin, then proceed to AN letter sending (Tab 3.6)" vertex="1">
          <mxGeometry height="80" width="180" x="2720" y="210" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_end" parent="sw_backend_3_6" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" value="End" vertex="1">
          <mxGeometry height="60" width="120" x="3080" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_sms_template" parent="sw_backend_3_6" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="SMS Template:&lt;br&gt;&lt;br&gt;Advisory Notice [NoticeNo]&lt;br&gt;Offence: [OffenceDescription]&lt;br&gt;Location: [PPName]&lt;br&gt;Date: [NoticeDate]&lt;br&gt;Amount: $[CompositionAmount]&lt;br&gt;Payment not accepted. You may appeal via OCMS portal." vertex="1">
          <mxGeometry height="140" width="320" x="510" y="200" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_email_template" parent="sw_backend_3_6" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="Email Template:&lt;br&gt;&lt;br&gt;Subject: Advisory Notice [NoticeNo] - [VehicleNo]&lt;br&gt;&lt;br&gt;Dear Vehicle Owner,&lt;br&gt;&lt;br&gt;This is an Advisory Notice for the following offence:&lt;br&gt;&lt;br&gt;Notice Number: [NoticeNo]&lt;br&gt;Vehicle Number: [VehicleNo]&lt;br&gt;Offence: [OffenceDescription]&lt;br&gt;Location: [PPName]&lt;br&gt;Date: [NoticeDate]&lt;br&gt;Composition Amount: $[CompositionAmount]&lt;br&gt;&lt;br&gt;This is an advisory notice only. Payment is not accepted at this time.&lt;br&gt;&lt;br&gt;You may appeal this notice via the OCMS portal at [PortalURL].&lt;br&gt;&lt;br&gt;Regards,&lt;br&gt;Urban Redevelopment Authority" vertex="1">
          <mxGeometry height="360" width="480" x="3240" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_retrieve_notice" parent="sw_backend_3_6" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="SELECT&amp;nbsp;&lt;div&gt;von.notice_no,&amp;nbsp;&lt;/div&gt;&lt;div&gt;von.vehicle_no,&amp;nbsp;&lt;/div&gt;&lt;div&gt;von.pp_name,&amp;nbsp;&lt;/div&gt;&lt;div&gt;von.notice_date_and_time,&amp;nbsp;&lt;/div&gt;&lt;div&gt;von.composition_amount,&amp;nbsp;&lt;/div&gt;&lt;div&gt;von.computer_rule_code&lt;br&gt;FROM ocms_valid_offence_notice AS von&lt;br&gt;WHERE von.notice_no =&#39;500400058A&#39;&lt;br&gt;AND von.an_flag = &#39;Y&#39;&lt;/div&gt;" vertex="1">
          <mxGeometry height="160" width="230" x="185" y="200" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_2" edge="1" parent="sw_backend_3_6" source="s3_6_step1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_6_retrieve_notice">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_api_email" parent="sw_backend_3_6" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="Email Service API:&lt;br&gt;&lt;br&gt;POST EMAIL_SERVICE_API/send&lt;br&gt;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;emailAddress&quot;: &quot;[owner_email]&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;subject&quot;: &quot;[eAN email subject]&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;body&quot;: &quot;[eAN email content]&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;sender&quot;: &quot;noreply@ura.gov.sg&quot;&lt;br&gt;}&lt;br&gt;&lt;br&gt;Response:&lt;br&gt;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;status&quot;: &quot;success/failed&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;messageId&quot;: &quot;string&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;timestamp&quot;: &quot;datetime&quot;&lt;br&gt;}&lt;br&gt;&lt;br&gt;Timeout: 10 seconds&lt;br&gt;Retry: 3 attempts" vertex="1">
          <mxGeometry height="280" width="340" x="1720" y="355" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_17" edge="1" parent="sw_backend_3_6" source="s3_6_step7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;exitX=0.25;exitY=1;exitDx=0;exitDy=0;" target="s3_6_api_email">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_api_sms" parent="sw_backend_3_6" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="SMS Gateway API:&lt;br&gt;&lt;br&gt;POST SMS_GATEWAY_API/send&lt;br&gt;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;mobileNumber&quot;: &quot;[owner_mobile]&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;message&quot;: &quot;[eAN SMS content]&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;sender&quot;: &quot;URA_OCMS&quot;&lt;br&gt;}&lt;br&gt;&lt;br&gt;Response:&lt;br&gt;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;status&quot;: &quot;success/failed&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;messageId&quot;: &quot;string&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;timestamp&quot;: &quot;datetime&quot;&lt;br&gt;}&lt;br&gt;&lt;br&gt;Timeout: 10 seconds&lt;br&gt;Retry: 3 attempts" vertex="1">
          <mxGeometry height="280" width="340" x="850" y="280" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_8" edge="1" parent="sw_backend_3_6" source="s3_6_step4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;exitX=0.25;exitY=1;exitDx=0;exitDy=0;" target="s3_6_api_sms">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_log_complete" parent="sw_backend_3_6" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="UPDATE ocms_valid_offence_notice&lt;br&gt;last_processing_stage = &#39;ENA&#39;,&lt;br&gt;next_processing_stage = NULL,&lt;br&gt;next_processing_date = NULL,&lt;br&gt;upd_date = CURRENT_TIMESTAMP,&lt;br&gt;upd_user_id = &#39;ocmsiz_app_conn&#39;&lt;br&gt;WHERE notice_no = [noticeNo]" vertex="1">
          <mxGeometry height="120" width="220" x="2930" y="330" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_26" edge="1" parent="sw_backend_3_6" source="s3_6_step11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="s3_6_log_complete">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2920" y="190" />
              <mxPoint x="3040" y="190" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="s3_6_update_status" parent="sw_backend_3_6" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="INSERT INTO ocms_suspended_notice&lt;br&gt;notice_no,&amp;nbsp;&lt;div&gt;date_of_suspension,&amp;nbsp;&lt;/div&gt;&lt;div&gt;sr_no,&amp;nbsp;&lt;/div&gt;&lt;div&gt;suspension_type,&amp;nbsp;&lt;/div&gt;&lt;div&gt;reason_of_suspension,&lt;br&gt;suspension_source,&amp;nbsp;&lt;/div&gt;&lt;div&gt;cre_date,&amp;nbsp;&lt;/div&gt;&lt;div&gt;cre_user_id)&lt;br&gt;&lt;br&gt;-- Suspend Notice with PS-ANS after successful eAN sending&lt;/div&gt;" vertex="1">
          <mxGeometry height="170" width="340" x="2520" y="410" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_24" edge="1" parent="sw_backend_3_6" source="s3_6_step10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_6_update_status">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_6_log_email" parent="sw_backend_3_6" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="INSERT INTO ocms_email_notification_records&lt;br&gt;notice_no,&amp;nbsp;&lt;div&gt;processing_stage,&amp;nbsp;&lt;/div&gt;&lt;div&gt;content,&amp;nbsp;&lt;/div&gt;&lt;div&gt;date_sent,&amp;nbsp;&lt;/div&gt;&lt;div&gt;email_addr,&amp;nbsp;&lt;/div&gt;&lt;div&gt;status,&amp;nbsp;&lt;/div&gt;&lt;div&gt;subject,&amp;nbsp;&lt;/div&gt;&lt;div&gt;cre_date,&amp;nbsp;&lt;/div&gt;&lt;div&gt;cre_user_id)&lt;br&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="160" width="280" x="2100" y="390" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_19" edge="1" parent="sw_backend_3_6" source="s3_6_step8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_6_log_email">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="RR_bfZvZPU4ydfOzuXTX-1" parent="sw_backend_3_6" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Retry SMS: Retry failed already 3 times?" vertex="1">
          <mxGeometry height="100" width="140" x="1520" y="200" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_13" edge="1" parent="sw_backend_3_6" source="s3_6_dec2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" target="RR_bfZvZPU4ydfOzuXTX-1" value="no">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1590" y="200" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_6_29" edge="1" parent="sw_backend_3_6" source="RR_bfZvZPU4ydfOzuXTX-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;" target="s3_6_fallback" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1590" y="340" />
              <mxPoint x="2810" y="340" />
            </Array>
            <mxPoint x="1590.0769230769229" y="280" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="RR_bfZvZPU4ydfOzuXTX-3" connectable="0" parent="c3_6_29" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="yes" vertex="1">
          <mxGeometry relative="1" x="-0.9725" y="2" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_6_14" edge="1" parent="sw_backend_3_6" source="RR_bfZvZPU4ydfOzuXTX-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;" target="s3_6_step4">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1160" y="250" />
            </Array>
            <mxPoint x="1510" y="250" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="RR_bfZvZPU4ydfOzuXTX-2" connectable="0" parent="c3_6_14" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="no" vertex="1">
          <mxGeometry relative="1" x="-0.7213" y="-1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_6_1" edge="1" parent="1" source="s3_6_start" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_6_step1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_3" edge="1" parent="1" source="s3_6_step1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_6_step2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_4" edge="1" parent="1" source="s3_6_step2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_6_step3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_5" edge="1" parent="1" source="s3_6_step3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_6_dec1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_6" edge="1" parent="1" source="s3_6_dec1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_6_step4" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_7" edge="1" parent="1" source="s3_6_dec1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;jumpStyle=arc;" target="s3_6_dec3" value="no">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="970" y="240" />
              <mxPoint x="1830" y="240" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_6_9" edge="1" parent="1" source="s3_6_step4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_6_step5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_10" edge="1" parent="1" source="s3_6_step5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_6_log_sms">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_11" edge="1" parent="1" source="s3_6_step5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_6_dec2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_12" edge="1" parent="1" source="s3_6_dec2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_6_dec3" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_15" edge="1" parent="1" source="s3_6_dec3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_6_step7" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_16" edge="1" parent="1" source="s3_6_dec3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_6_step10" value="no">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1830" y="110" />
              <mxPoint x="2710" y="110" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_6_18" edge="1" parent="1" source="s3_6_step7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_6_step8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_20" edge="1" parent="1" source="s3_6_step8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_6_dec4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_21" edge="1" parent="1" source="s3_6_dec4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_6_step10" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_23" edge="1" parent="1" source="RR_bfZvZPU4ydfOzuXTX-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;" target="s3_6_step7">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2040" y="330" />
            </Array>
            <mxPoint x="2469.9999999999995" y="360" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="RR_bfZvZPU4ydfOzuXTX-8" connectable="0" parent="c3_6_23" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="no" vertex="1">
          <mxGeometry relative="1" x="-0.8353" y="-1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_6_25" edge="1" parent="1" source="s3_6_step10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_6_step11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_27" edge="1" parent="1" source="s3_6_step11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_6_end">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_28" edge="1" parent="1" source="s3_6_fallback" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_6_end">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_6_30" edge="1" parent="1" source="RR_bfZvZPU4ydfOzuXTX-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;" target="s3_6_fallback" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
            <mxPoint x="2550.0000000000005" y="330" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="RR_bfZvZPU4ydfOzuXTX-9" connectable="0" parent="c3_6_30" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="yes" vertex="1">
          <mxGeometry relative="1" x="-0.7688" y="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="s3_6_log_sms" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="INSERT INTO ocms_sms_notification_records&lt;br&gt;notice_no,&amp;nbsp;&lt;div&gt;processing_stage,&amp;nbsp;&lt;/div&gt;&lt;div&gt;content,&amp;nbsp;&lt;/div&gt;&lt;div&gt;date_sent,&amp;nbsp;&lt;/div&gt;&lt;div&gt;mobile_no,&amp;nbsp;&lt;/div&gt;&lt;div&gt;status,&amp;nbsp;&lt;/div&gt;&lt;div&gt;cre_date,&amp;nbsp;&lt;/div&gt;&lt;div&gt;cre_user_id&lt;br&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="140" width="260" x="1270" y="540" as="geometry" />
        </mxCell>
        <mxCell id="RR_bfZvZPU4ydfOzuXTX-4" parent="1" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Retry SMS: Retry failed already 3 times?" vertex="1">
          <mxGeometry height="100" width="140" x="2400" y="280" as="geometry" />
        </mxCell>
        <mxCell id="RR_bfZvZPU4ydfOzuXTX-6" edge="1" parent="1" source="s3_6_dec4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" target="RR_bfZvZPU4ydfOzuXTX-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="RR_bfZvZPU4ydfOzuXTX-7" connectable="0" parent="RR_bfZvZPU4ydfOzuXTX-6" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="no" vertex="1">
          <mxGeometry relative="1" x="0.0833" y="-2" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="tab3_6" name="3.6_Send_AN_Letter">
    <mxGraphModel dx="2360" dy="1383" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="8000" pageHeight="2000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title_tab3_7" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=16;fontStyle=1" value="Section 3.6: Send AN Letter (SLIFT)" vertex="1">
          <mxGeometry height="30" width="600" x="40" y="20" as="geometry" />
        </mxCell>
        <mxCell id="sw_backend_3_7" parent="1" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" value="Backend (OCMS API)" vertex="1">
          <mxGeometry height="770" width="2920" x="20" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_7_start" parent="sw_backend_3_7" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" value="Start" vertex="1">
          <mxGeometry height="60" width="120" x="40" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_7_step1" parent="sw_backend_3_7" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Retrieve Notice Details" vertex="1">
          <mxGeometry height="80" width="160" x="220" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_7_step2" parent="sw_backend_3_7" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Retrieve Owner Address: From MHA API response (building name, street, postal code, unit)" vertex="1">
          <mxGeometry height="80" width="180" x="440" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_7_step3" parent="sw_backend_3_7" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Retrieve Owner Name: From LTA API response" vertex="1">
          <mxGeometry height="80" width="160" x="680" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_7_step4" parent="sw_backend_3_7" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Generate Letter Template: Create PDF/XML with notice details, owner address, letter content" vertex="1">
          <mxGeometry height="80" width="180" x="900" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_7_step5" parent="sw_backend_3_7" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Populate Letter Fields: Fill template with notice number, vehicle number, offence details, owner name/address" vertex="1">
          <mxGeometry height="80" width="200" x="1140" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_7_step6" parent="sw_backend_3_7" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Format Letter Content: Format per SLIFT)" vertex="1">
          <mxGeometry height="80" width="160" x="1400" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_7_dec1" parent="sw_backend_3_7" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Valid Letter? (PDF/XML generated successfully)" vertex="1">
          <mxGeometry height="100" width="140" x="1620" y="40" as="geometry" />
        </mxCell>
        <mxCell id="s3_7_step7" parent="sw_backend_3_7" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Call SLIFT API to submit letter for printing and mailing" vertex="1">
          <mxGeometry height="80" width="180" x="1820" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_7_dec2" parent="sw_backend_3_7" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="SLIFT Success?" vertex="1">
          <mxGeometry height="100" width="140" x="2060" y="40" as="geometry" />
        </mxCell>
        <mxCell id="s3_7_step8" parent="sw_backend_3_7" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Create AN Letter Record: Insert record into ocms_an_letter table" vertex="1">
          <mxGeometry height="80" width="180" x="2260" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_7_step9" parent="sw_backend_3_7" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Proceed to Suspension: Trigger PS-ANS suspension flow" vertex="1">
          <mxGeometry height="80" width="160" x="2500" y="50" as="geometry" />
        </mxCell>
        <mxCell id="s3_7_manual" parent="sw_backend_3_7" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Manual Review Queue: Send email alert to admin, add to manual review queue after 3 failed retries" vertex="1">
          <mxGeometry height="80" width="180" x="1600" y="360" as="geometry" />
        </mxCell>
        <mxCell id="s3_7_error_log" parent="sw_backend_3_7" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Log Error: Log error with reason, move to manual review" vertex="1">
          <mxGeometry height="80" width="160" x="1610" y="210" as="geometry" />
        </mxCell>
        <mxCell id="s3_7_end" parent="sw_backend_3_7" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" value="End" vertex="1">
          <mxGeometry height="60" width="120" x="2770" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_7_query_notice" parent="sw_backend_3_7" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="SELECT&amp;nbsp;&lt;div&gt;von.notice_no,&amp;nbsp;&lt;/div&gt;&lt;div&gt;von.vehicle_no,&amp;nbsp;&lt;/div&gt;&lt;div&gt;von.computer_rule_code,&amp;nbsp;&lt;/div&gt;&lt;div&gt;von.composition_amount,&amp;nbsp;&lt;/div&gt;&lt;div&gt;ond.pp_name,&amp;nbsp;&lt;/div&gt;&lt;div&gt;von.notice_date_and_time&lt;br&gt;FROM ocms_valid_offence_notice AS von&lt;br&gt;JOIN ocms_offence_notice_detail AS ond ON von.notice_no = ond.notice_no&lt;br&gt;LEFT JOIN ocms_an_letter anl ON von.notice_no = anl.notice_no&lt;br&gt;WHERE von.an_flag = &#39;Y&#39;&lt;br&gt;&amp;nbsp;&amp;nbsp;AND von.last_processing_stage IN (&#39;ENA&#39;, &#39;ROV&#39;, &#39;NPA&#39;)&lt;br&gt;&amp;nbsp;&amp;nbsp;AND anl.notice_no IS NULL&lt;/div&gt;" vertex="1">
          <mxGeometry height="200" width="420" x="90" y="180" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_2" edge="1" parent="sw_backend_3_7" source="s3_7_step1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_7_query_notice">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_7_update_status" parent="sw_backend_3_7" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="INSERT INTO ocms_an_letter&lt;br&gt;notice_no,&amp;nbsp;&lt;div&gt;date_of_processing,&amp;nbsp;&lt;/div&gt;&lt;div&gt;date_of_an_letter,&lt;br&gt;owner_nric_no,&amp;nbsp;&lt;/div&gt;&lt;div&gt;owner_name,&amp;nbsp;&lt;/div&gt;&lt;div&gt;owner_id_type,&lt;br&gt;owner_blk_hse_no,&amp;nbsp;&lt;/div&gt;&lt;div&gt;owner_street,&amp;nbsp;&lt;/div&gt;&lt;div&gt;owner_floor,&amp;nbsp;&lt;/div&gt;&lt;div&gt;owner_unit,&lt;br&gt;owner_bldg,&amp;nbsp;&lt;/div&gt;&lt;div&gt;owner_postal_code,&amp;nbsp;&lt;/div&gt;&lt;div&gt;processing_stage,&lt;br&gt;cre_date,&amp;nbsp;&lt;/div&gt;&lt;div&gt;cre_user_id&lt;br&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="240" width="180" x="2260" y="170" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_15" edge="1" parent="sw_backend_3_7" source="s3_7_step8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_7_update_status">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_7_insert_log" parent="sw_backend_3_7" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="After AN Letter record created:&lt;br&gt;&lt;br&gt;1. SLIFT submission_id stored in ocms_an_letter&lt;br&gt;2. Proceed to PS-ANS suspension&lt;br&gt;3. Notice processing stops after suspension&lt;div&gt;&lt;br/&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="90" width="270" x="2480" y="170" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_17" edge="1" parent="sw_backend_3_7" source="s3_7_step9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_7_insert_log">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3r0IqP37o0qrPyXTNc9M-1" parent="sw_backend_3_7" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Already retry 3 times?" vertex="1">
          <mxGeometry height="100" width="140" x="2060" y="210" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_14" edge="1" parent="sw_backend_3_7" source="s3_7_dec2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" target="3r0IqP37o0qrPyXTNc9M-1" value="no">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2130" y="240" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_7_19" edge="1" parent="sw_backend_3_7" source="3r0IqP37o0qrPyXTNc9M-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;" target="s3_7_step7" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1910" y="260" />
            </Array>
            <mxPoint x="2040" y="280" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="3r0IqP37o0qrPyXTNc9M-3" connectable="0" parent="c3_7_19" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="no" vertex="1">
          <mxGeometry relative="1" x="-0.7328" y="-2" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="s3_7_letter_template" parent="sw_backend_3_7" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="AN Letter Content Template:&lt;br&gt;&lt;br&gt;Urban Redevelopment Authority&lt;br&gt;Car Parks Department&lt;br&gt;&lt;br&gt;[Owner Name]&lt;br&gt;[Building Name]&lt;br&gt;[Street Name]&lt;br&gt;[Unit Number]&lt;br&gt;[Postal Code]&lt;br&gt;&lt;br&gt;Date: [Current Date]&lt;br&gt;&lt;br&gt;Advisory Notice Number: [NoticeNo]&lt;br&gt;&lt;br&gt;Dear Sir/Madam,&lt;br&gt;&lt;br&gt;RE: ADVISORY NOTICE - VEHICLE [VehicleNo]&lt;br&gt;&lt;br&gt;This is an Advisory Notice for the following parking offence:&lt;br&gt;&lt;br&gt;Offence Details:&lt;br&gt;- Notice Number: [NoticeNo]&lt;br&gt;- Vehicle Number: [VehicleNo]&lt;br&gt;- Offence: [OffenceDescription]&lt;br&gt;- Location: [PPName]&lt;br&gt;- Date and Time: [NoticeDateAndTime]&lt;br&gt;- Composition Amount: $[CompositionAmount]&lt;br&gt;&lt;br&gt;This is an advisory notice only. Payment is not accepted for this notice.&lt;br&gt;&lt;br&gt;You have the right to appeal this notice. Please visit the OCMS portal&lt;br&gt;at [PortalURL] to submit your appeal.&lt;br&gt;&lt;br&gt;If you have any questions, please contact us at [ContactNumber].&lt;br&gt;&lt;br&gt;Yours faithfully,&lt;br&gt;Urban Redevelopment Authority" vertex="1">
          <mxGeometry height="560" width="480" x="850" y="160" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_1" edge="1" parent="1" source="s3_7_start" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_7_step1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_3" edge="1" parent="1" source="s3_7_step1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_7_step2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_4" edge="1" parent="1" source="s3_7_step2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_7_step3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_5" edge="1" parent="1" source="s3_7_step3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_7_step4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_6" edge="1" parent="1" source="s3_7_step4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_7_step5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_7" edge="1" parent="1" source="s3_7_step5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_7_step6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_8" edge="1" parent="1" source="s3_7_step6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_7_dec1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_9" edge="1" parent="1" source="s3_7_dec1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_7_step7" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_10" edge="1" parent="1" source="s3_7_dec1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_7_error_log" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_11" edge="1" parent="1" source="s3_7_step7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;exitX=0.25;exitY=1;exitDx=0;exitDy=0;" target="s3_7_api_slift">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_12" edge="1" parent="1" source="s3_7_step7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_7_dec2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_13" edge="1" parent="1" source="s3_7_dec2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_7_step8" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_16" edge="1" parent="1" source="s3_7_step8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_7_step9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_18" edge="1" parent="1" source="s3_7_step9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_7_end">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_20" edge="1" parent="1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_7_manual" value="yes">
          <mxGeometry relative="1" x="-0.907" as="geometry">
            <mxPoint as="offset" />
            <Array as="points">
              <mxPoint x="2150" y="480" />
              <mxPoint x="1720" y="480" />
            </Array>
            <mxPoint x="2149.947368421053" y="400" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_7_21" edge="1" parent="1" source="s3_7_error_log" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_7_manual">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_7_22" edge="1" parent="1" source="s3_7_manual" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" target="s3_7_end">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1710" y="600" />
              <mxPoint x="2860" y="600" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="s3_7_api_slift" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="SLIFT API:&lt;br&gt;&lt;br&gt;POST SLIFT_API/submit&lt;br&gt;Headers:&lt;br&gt;&amp;nbsp;&amp;nbsp;API-Key: [from Azure Key Vault]&lt;br&gt;&lt;br&gt;Body (multipart/form-data):&lt;br&gt;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;noticeNumber&quot;: &quot;[notice_no]&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;vehicleNumber&quot;: &quot;[vehicle_no]&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;letterFile&quot;: &quot;[PDF/XML file]&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;letterType&quot;: &quot;ADVISORY_NOTICE&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;recipientName&quot;: &quot;[owner_name]&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;recipientAddress&quot;: &quot;[full_address]&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;priority&quot;: &quot;NORMAL&quot;&lt;br&gt;}&lt;br&gt;&lt;br&gt;Response:&lt;br&gt;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;status&quot;: &quot;success/failed&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;submissionId&quot;: &quot;string&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;timestamp&quot;: &quot;datetime&quot;,&lt;br&gt;&amp;nbsp;&amp;nbsp;&quot;estimatedPrintDate&quot;: &quot;date&quot;&lt;br&gt;}&lt;br&gt;&lt;br&gt;Timeout: 30 seconds&lt;br&gt;Retry: 3 attempts with exponential backoff (1s, 2s, 4s)&lt;br&gt;File Format: PDF (preferred) or XML" vertex="1">
          <mxGeometry height="420" width="420" x="1674" y="880" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="tab3_7" name="3.7_Suspend_PS_ANS">
    <mxGraphModel dx="2065" dy="1210" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="5000" pageHeight="1500" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title_3_8" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=16;fontStyle=1" value="Section 3.7: Suspend Notice with PS-ANS" vertex="1">
          <mxGeometry height="30" width="600" x="40" y="20" as="geometry" />
        </mxCell>
        <mxCell id="sw_backend_3_8" parent="1" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" value="Backend (OCMS API)" vertex="1">
          <mxGeometry height="720" width="2180" x="20" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_8_start" parent="sw_backend_3_8" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" value="Start" vertex="1">
          <mxGeometry height="60" width="120" x="40" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_8_step1" parent="sw_backend_3_8" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Retrieve Notice Details (notice number, notice date)" vertex="1">
          <mxGeometry height="100" width="160" x="220" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_8_step2" parent="sw_backend_3_8" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Calculate Suspension Date: Set date_of_suspension = current date" vertex="1">
          <mxGeometry height="100" width="160" x="440" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_8_step3" parent="sw_backend_3_8" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Calculate Revival Date: Set due_date_of_revival = current date + 30 days (configurable)" vertex="1">
          <mxGeometry height="100" width="180" x="660" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_8_step4" parent="sw_backend_3_8" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Generate SR Number: Create sequential sr_no" vertex="1">
          <mxGeometry height="100" width="160" x="900" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_8_step5" parent="sw_backend_3_8" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Create Suspension Record in ocms_suspended_notice" vertex="1">
          <mxGeometry height="100" width="160" x="1120" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_8_step6" parent="sw_backend_3_8" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Update Notice with Suspension details in ocms_valid_offence_notice" vertex="1">
          <mxGeometry height="100" width="180" x="1340" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_8_step7" parent="sw_backend_3_8" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Sync to Internet DB to eocms_valid_offence_notice" vertex="1">
          <mxGeometry height="100" width="180" x="1580" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_8_step8" parent="sw_backend_3_8" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Log Suspension Created with timestamp" vertex="1">
          <mxGeometry height="100" width="160" x="1820" y="60" as="geometry" />
        </mxCell>
        <mxCell id="s3_8_end" parent="sw_backend_3_8" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" value="End" vertex="1">
          <mxGeometry height="60" width="120" x="2040" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_8_insert_susp" parent="sw_backend_3_8" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="INSERT ocms_suspended_notice:&lt;br&gt;&lt;br&gt;- notice_no&lt;br&gt;- date_of_suspension: Current date&lt;br&gt;- sr_no: Sequential number&lt;br&gt;- suspension_type: &#39;PS&#39;&lt;br&gt;- reason_of_suspension: &#39;ANS&#39;&lt;br&gt;- suspension_source: &#39;ocmsiz_app_conn&#39;&lt;br&gt;- officer_authorising_suspension: &#39;ocmsizmgr_conn&#39;&lt;br&gt;- due_date_of_revival: current date + 30 days&lt;br&gt;- suspension_remarks: &#39;Advisory Notice detected - qualified AN&#39;&lt;br&gt;- cre_user_id: &#39;ocmsiz_app_conn&#39;&lt;br&gt;- cre_date: Current timestamp" vertex="1">
          <mxGeometry height="200" width="340" x="950" y="220" as="geometry" />
        </mxCell>
        <mxCell id="c3_8_6" edge="1" parent="sw_backend_3_8" source="s3_8_step5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_8_insert_susp">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_8_sync_internet" parent="sw_backend_3_8" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="INSERT/UPDATE eocms_valid_offence_notice:&lt;br&gt;&lt;br&gt;Mirror same suspension fields from intranet table:&lt;br&gt;- suspension_type&lt;br&gt;- epr_reason_of_suspension&lt;br&gt;- epr_date_of_suspension&lt;br&gt;- due_date_of_revival&lt;br&gt;&lt;br&gt;&lt;b&gt;Error Handling:&lt;/b&gt;&lt;br&gt;If sync fails:&lt;br&gt;1. Retry 3 times with exponential backoff&lt;br&gt;2. Log error with notice_no, timestamp, error message&lt;br&gt;3. Add to pending sync queue for manual retry&lt;br&gt;4. Send email alert to admin&lt;br&gt;5. Intranet record remains valid (committed)&lt;br&gt;&lt;br&gt;Note: Sync is eventual consistency - intranet is source of truth" vertex="1">
          <mxGeometry height="260" width="350" x="1580" y="220" as="geometry" />
        </mxCell>
        <mxCell id="c3_8_10" edge="1" parent="sw_backend_3_8" source="s3_8_step7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_8_sync_internet">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_8_update_notice" parent="sw_backend_3_8" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="UPDATE ocms_valid_offence_notice:&lt;br&gt;&lt;br&gt;- suspension_type: &#39;PS&#39;&lt;br&gt;- epr_reason_of_suspension: &#39;ANS&#39;&lt;br&gt;- epr_date_of_suspension: Current date&lt;br&gt;- due_date_of_revival: current date + 30 days&lt;br&gt;- upd_user_id: &#39;ocmsiz_app_conn&#39;&lt;br&gt;- upd_date: Current timestamp" vertex="1">
          <mxGeometry height="130" width="250" x="1305" y="200" as="geometry" />
        </mxCell>
        <mxCell id="c3_8_8" edge="1" parent="sw_backend_3_8" source="s3_8_step6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_8_update_notice">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_8_1" edge="1" parent="1" source="s3_8_start" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_8_step1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_8_2" edge="1" parent="1" source="s3_8_step1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_8_step2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_8_3" edge="1" parent="1" source="s3_8_step2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_8_step3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_8_4" edge="1" parent="1" source="s3_8_step3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_8_step4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_8_5" edge="1" parent="1" source="s3_8_step4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_8_step5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_8_7" edge="1" parent="1" source="s3_8_step5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_8_step6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_8_9" edge="1" parent="1" source="s3_8_step6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_8_step7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_8_11" edge="1" parent="1" source="s3_8_step7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_8_step8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_8_12" edge="1" parent="1" source="s3_8_step8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_8_end">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="tab3_8" name="3.8_Generate_ANS_Reports">
    <mxGraphModel dx="4130" dy="2420" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="8000" pageHeight="2000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title_tab3_9" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=16;fontStyle=1" value="Section 3.8: Generate ANS Reports" vertex="1">
          <mxGeometry height="30" width="600" x="40" y="20" as="geometry" />
        </mxCell>
        <mxCell id="sw_frontend_3_9" parent="1" style="swimlane;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" value="Frontend (Staff Portal)" vertex="1">
          <mxGeometry height="280" width="3420" x="20" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_start" parent="sw_frontend_3_9" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" value="Start" vertex="1">
          <mxGeometry height="60" width="120" x="40" y="100" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_receive_request" parent="sw_frontend_3_9" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Receive Report Parameters&#xa;(Date From, Date To, Vehicle Number, Subsystem)" vertex="1">
          <mxGeometry height="100" width="160" x="220" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_display_error" parent="sw_frontend_3_9" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Display Error Message&#xa;(Invalid Parameters)" vertex="1">
          <mxGeometry height="100" width="160" x="1070" y="70" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_display_nodata" parent="sw_frontend_3_9" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Display No Data Message&#xa;&#39;No records found for the selected criteria&#39;" vertex="1">
          <mxGeometry height="100" width="180" x="3150" y="140" as="geometry" />
        </mxCell>
        <mxCell id="sw_backend_3_9" parent="1" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" value="Backend (OCMS API)" vertex="1">
          <mxGeometry height="800" width="3420" x="20" y="385" as="geometry" />
        </mxCell>
        <mxCell id="9VMB-lNLdUTSCDfsktMN-2" edge="1" parent="sw_backend_3_9" source="s3_9_validate_params" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;dashPattern=8 8;" target="9VMB-lNLdUTSCDfsktMN-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_validate_params" parent="sw_backend_3_9" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Validate Parameters" vertex="1">
          <mxGeometry height="100" width="180" x="440" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_dec_valid" parent="sw_backend_3_9" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Valid Parameters?" vertex="1">
          <mxGeometry height="120" width="140" x="730" y="70" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_return_error" parent="sw_backend_3_9" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;fillColor=#fff2cc;strokeColor=#d6b656;" value="Return Error Response:&#xa;&#39;Invalid parameters - Date range exceeds 31 days&#39;" vertex="1">
          <mxGeometry height="100" width="180" x="1060" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_apply_filters" parent="sw_backend_3_9" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Apply Filters:&#xa;- Vehicle number&#xa;- Subsystem&#xa;- Date range" vertex="1">
          <mxGeometry height="100" width="160" x="1460" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_dec_records" parent="sw_backend_3_9" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" value="Any Records?" vertex="1">
          <mxGeometry height="120" width="140" x="1690" y="70" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_return_nodata" parent="sw_backend_3_9" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Return No Data Message:&#xa;&#39;No records found for the selected criteria&#39;" vertex="1">
          <mxGeometry height="100" width="180" x="2080" y="370" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_sort_results" parent="sw_backend_3_9" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Sort Results&#xa;by Suspension Date Descending" vertex="1">
          <mxGeometry height="100" width="160" x="1900" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_format_data" parent="sw_backend_3_9" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Format Report Data&#xa;(Excel/PDF columns)" vertex="1">
          <mxGeometry height="100" width="160" x="2120" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_generate_file" parent="sw_backend_3_9" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Generate Report File&#xa;(Excel/PDF format)" vertex="1">
          <mxGeometry height="100" width="160" x="2340" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_batch_note" parent="sw_backend_3_9" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="&lt;b&gt;Large Dataset Handling:&lt;/b&gt;&lt;br&gt;&lt;br&gt;Max Records: 10,000 per report&lt;br&gt;&lt;br&gt;If records &gt; 10,000:&lt;br&gt;1. Return warning to user&lt;br&gt;2. Suggest narrowing date range&lt;br&gt;3. Apply limit to query (FETCH FIRST 10000)&lt;br&gt;&lt;br&gt;Note: Date range max 31 days also&lt;br&gt;helps limit result size" vertex="1">
          <mxGeometry height="200" width="280" x="2290" y="205" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_log_report" parent="sw_backend_3_9" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Log Report Generated&#xa;(Parameters, Timestamp, User)" vertex="1">
          <mxGeometry height="100" width="180" x="2560" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_query_notices" parent="sw_backend_3_9" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Query ANS Suspension Data" vertex="1">
          <mxGeometry height="80" width="180" x="710" y="265" as="geometry" />
        </mxCell>
        <mxCell id="c3_9_6" edge="1" parent="sw_backend_3_9" source="s3_9_dec_valid" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_9_query_notices" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_9_7" edge="1" parent="sw_backend_3_9" source="s3_9_query_notices" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_9_apply_filters">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_query_box" parent="sw_backend_3_9" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="SELECT&lt;br&gt;  sn.notice_no,&lt;br&gt;  sn.date_of_suspension,&lt;br&gt;  sn.due_date_of_revival,&lt;br&gt;  sn.suspension_remarks,&lt;br&gt;  von.vehicle_no,&lt;br&gt;  von.subsystem_label,&lt;br&gt;  von.computer_rule_code,&lt;br&gt;  von.composition_amount,&lt;br&gt;  von.notice_date_and_time,&lt;br&gt;  von.pp_code,&lt;br&gt;  von.pp_name,&lt;br&gt;  von.offence_notice_type&lt;br&gt;FROM ocms_suspended_notice sn&lt;br&gt;INNER JOIN ocms_valid_offence_notice von&lt;br&gt;  ON sn.notice_no = von.notice_no&lt;br&gt;WHERE sn.reason_of_suspension = &#39;ANS&#39;&lt;br&gt;  AND sn.date_of_suspension BETWEEN [dateFrom] AND [dateTo]&lt;br&gt;  AND ([vehicleNo] IS NULL OR von.vehicle_no = [vehicleNo])&lt;br&gt;  AND ([subsystem] IS NULL OR von.subsystem_label = [subsystem])&lt;br&gt;ORDER BY sn.date_of_suspension DESC, sn.notice_no ASC" vertex="1">
          <mxGeometry height="325" width="380" x="610" y="385" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_sort_note" parent="sw_backend_3_9" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="&lt;b&gt;Sort Criteria:&lt;/b&gt;&lt;br&gt;&lt;br&gt;Primary: date_of_suspension DESC&lt;br&gt;(Newest suspensions first)&lt;br&gt;&lt;br&gt;Secondary: notice_no ASC&lt;br&gt;(Consistent order when same date)" vertex="1">
          <mxGeometry height="130" width="200" x="1880" y="220" as="geometry" />
        </mxCell>
        <mxCell id="c3_9_sort_link" edge="1" parent="sw_backend_3_9" source="s3_9_sort_results" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_9_sort_note">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_9_8" edge="1" parent="sw_backend_3_9" source="s3_9_query_notices" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_9_query_box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9VMB-lNLdUTSCDfsktMN-1" parent="sw_backend_3_9" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=middle;rounded=0;autosize=1;resizable=0;" value="- Date range max 31 days&lt;br&gt;- Date From &amp;lt;= Date To&lt;br&gt;- Required fields present" vertex="1">
          <mxGeometry height="60" width="160" x="450" y="220" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_return_report" parent="sw_backend_3_9" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Return Report File&#xa;for Download" vertex="1">
          <mxGeometry height="100" width="160" x="2805" y="80" as="geometry" />
        </mxCell>
        <mxCell id="s3_9_output_box" parent="sw_backend_3_9" style="text;html=1;whiteSpace=wrap;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;rounded=0;" value="Report Output Format:&lt;br&gt;&lt;br&gt;Excel Columns:&lt;br&gt;1. Notice Number&lt;br&gt;2. Vehicle Number&lt;br&gt;3. Subsystem&lt;br&gt;4. Suspension Date&lt;br&gt;5. Revival Date&lt;br&gt;6. Offence Code&lt;br&gt;7. Composition Amount&lt;br&gt;8. Notice Date&lt;br&gt;9. Parking Place&lt;br&gt;10. Suspension Remarks&lt;br&gt;&lt;br&gt;PDF Structure:&lt;br&gt;Advisory Notice Suspension Report&lt;br&gt;Generated: [Current Date Time]&lt;br&gt;Date Range: [Date From] to [Date To]&lt;br&gt;&lt;br&gt;Total Records: [Count]" vertex="1">
          <mxGeometry height="305" width="210" x="2780" y="225" as="geometry" />
        </mxCell>
        <mxCell id="c3_9_17" edge="1" parent="sw_backend_3_9" source="s3_9_return_report" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" target="s3_9_output_box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_9_1" edge="1" parent="1" source="s3_9_start" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_9_receive_request">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_9_2" edge="1" parent="1" source="s3_9_receive_request" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_9_validate_params">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_9_4" edge="1" parent="1" source="s3_9_validate_params" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_9_dec_valid">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_9_5" edge="1" parent="1" source="s3_9_dec_valid" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_9_return_error" value="no">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_9_10" edge="1" parent="1" source="s3_9_apply_filters" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_9_dec_records">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_9_11" edge="1" parent="1" source="s3_9_dec_records" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="s3_9_return_nodata" value="no">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1780" y="800" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3_9_12" edge="1" parent="1" source="s3_9_dec_records" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_9_sort_results" value="yes">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_9_13" edge="1" parent="1" source="s3_9_sort_results" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_9_format_data">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_9_14" edge="1" parent="1" source="s3_9_format_data" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_9_generate_file">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_9_15" edge="1" parent="1" source="s3_9_generate_file" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_9_log_report">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_9_16" edge="1" parent="1" source="s3_9_log_report" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_9_return_report">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_9_19" edge="1" parent="1" source="s3_9_return_error" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_9_display_error">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c3_9_20" edge="1" parent="1" source="s3_9_return_nodata" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_9_display_nodata">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2190" y="970" />
              <mxPoint x="3260" y="970" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="s3_9_download_report" parent="1" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="Download Report&#xa;(Excel/PDF)" vertex="1">
          <mxGeometry height="100" width="160" x="2825" y="220" as="geometry" />
        </mxCell>
        <mxCell id="c3_9_18" edge="1" parent="1" source="s3_9_return_report" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="s3_9_download_report">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="tab3_9" name="3.9_Send_Unqualified_List">
    <mxGraphModel dx="1652" dy="968" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="6000" pageHeight="1800" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title_tab3_10" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=16;fontStyle=1" value="Section 3.9: Send Unqualified AN List (REPCCS/CES)" vertex="1">
          <mxGeometry height="30" width="600" x="40" y="20" as="geometry" />
        </mxCell>
        <mxCell id="lane_backend_310" parent="1" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" value="Backend (Cron)" vertex="1">
          <mxGeometry height="890" width="4670" x="20" y="80" as="geometry" />
        </mxCell>
        <mxCell id="x6ROZ4C58ZNDYvBh47Pb-1" parent="lane_backend_310" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Calculate Date Range&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;(Previous Day)&lt;/span&gt;" vertex="1">
          <mxGeometry height="100" width="180" x="360" y="60" as="geometry" />
        </mxCell>
        <mxCell id="edge_query_filter_310" edge="1" parent="lane_backend_310" source="x6ROZ4C58ZNDYvBh47Pb-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="x6ROZ4C58ZNDYvBh47Pb-3" value="">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="740" y="380.05882352941194" as="sourcePoint" />
            <mxPoint x="630.0000000000002" y="110" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x6ROZ4C58ZNDYvBh47Pb-3" parent="lane_backend_310" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Filter by Subsystem&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;(REPCCS vs CES)&lt;/span&gt;" vertex="1">
          <mxGeometry height="100" width="180" x="620" y="60" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-3" parent="lane_backend_310" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Generate REPCCS File&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;(CSV Format)&lt;/span&gt;" vertex="1">
          <mxGeometry height="100" width="180" x="1190" y="60" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-4" parent="lane_backend_310" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Upload File to SFTP&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;(REPCCS)&lt;/span&gt;" vertex="1">
          <mxGeometry height="100" width="180" x="1470" y="60" as="geometry" />
        </mxCell>
        <mxCell id="edge_generate_upload_repccs_310" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="PEkpuAo8z3JMSkmCLv0X-4" value="">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1350" y="110" as="sourcePoint" />
            <mxPoint x="2200" y="110" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-6" parent="lane_backend_310" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;direction=south;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Upload&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;Success?&lt;/span&gt;" vertex="1">
          <mxGeometry height="140" width="120" x="1730" y="40" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-7" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;" target="PEkpuAo8z3JMSkmCLv0X-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-11" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;" target="PEkpuAo8z3JMSkmCLv0X-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-12" connectable="0" parent="PEkpuAo8z3JMSkmCLv0X-11" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="no" vertex="1">
          <mxGeometry relative="1" x="-0.6777" y="-3" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-14" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="PEkpuAo8z3JMSkmCLv0X-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-15" connectable="0" parent="PEkpuAo8z3JMSkmCLv0X-14" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="yes" vertex="1">
          <mxGeometry relative="1" x="-0.141" y="-3" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-8" parent="lane_backend_310" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;direction=south;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Already retry 3 times?&lt;/span&gt;" vertex="1">
          <mxGeometry height="140" width="120" x="1730" y="240" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-9" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" target="PEkpuAo8z3JMSkmCLv0X-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-10" connectable="0" parent="PEkpuAo8z3JMSkmCLv0X-9" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="no" vertex="1">
          <mxGeometry relative="1" x="-0.1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-13" parent="lane_backend_310" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Log Upload error&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;(REPCCS)&lt;/span&gt;" vertex="1">
          <mxGeometry height="100" width="180" x="1700" y="440" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-16" parent="lane_backend_310" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Log Upload Success&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;(REPCCS)&lt;/span&gt;" vertex="1">
          <mxGeometry height="100" width="180" x="1980" y="60" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-17" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;" target="PEkpuAo8z3JMSkmCLv0X-16" value="">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1850" y="110" as="sourcePoint" />
            <mxPoint x="2640" y="110" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-18" connectable="0" parent="PEkpuAo8z3JMSkmCLv0X-17" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="yes" vertex="1">
          <mxGeometry relative="1" x="-0.187" y="-2" as="geometry">
            <mxPoint x="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-19" parent="lane_backend_310" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;direction=south;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Any CES&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;Records?&lt;/span&gt;" vertex="1">
          <mxGeometry height="140" width="120" x="2250" y="40" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-20" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;" target="PEkpuAo8z3JMSkmCLv0X-19">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="edge_decision_generate_ces_310" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="PEkpuAo8z3JMSkmCLv0X-21" value="YES">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3020" y="110" as="sourcePoint" />
            <mxPoint x="2660" y="110" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-24" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="PEkpuAo8z3JMSkmCLv0X-22">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-21" parent="lane_backend_310" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Generate CES File&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;(CSV Format)&lt;/span&gt;" vertex="1">
          <mxGeometry height="100" width="180" x="2500" y="60" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-22" parent="lane_backend_310" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Upload File to SFTP&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;(CES)&lt;/span&gt;" vertex="1">
          <mxGeometry height="100" width="180" x="2810" y="60" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-34" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="PEkpuAo8z3JMSkmCLv0X-33">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-23" parent="lane_backend_310" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;direction=south;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Upload&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;Success?&lt;/span&gt;" vertex="1">
          <mxGeometry height="140" width="120" x="3130" y="40" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-25" connectable="0" parent="lane_backend_310" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="no" vertex="1">
          <mxGeometry x="3080" y="307" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-26" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="PEkpuAo8z3JMSkmCLv0X-29">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-27" connectable="0" parent="PEkpuAo8z3JMSkmCLv0X-26" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="yes" vertex="1">
          <mxGeometry relative="1" x="-0.141" y="-3" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-32" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;" target="PEkpuAo8z3JMSkmCLv0X-22">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-28" parent="lane_backend_310" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;direction=south;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Already retry 3 times?&lt;/span&gt;" vertex="1">
          <mxGeometry height="140" width="120" x="3129.9963636363636" y="240" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-29" parent="lane_backend_310" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Log Upload error&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;(CES)&lt;/span&gt;" vertex="1">
          <mxGeometry height="100" width="180" x="3099.9963636363636" y="460" as="geometry" />
        </mxCell>
        <mxCell id="info_ces_sftp_310" parent="lane_backend_310" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;verticalAlign=top;fontSize=11;" value="&lt;b&gt;CES SFTP Details:&lt;/b&gt;&lt;br&gt;Protocol: SFTP&lt;br&gt;Server: [from Azure Key Vault: CES_SFTP_HOST]&lt;br&gt;Port: 22&lt;br&gt;Username: [from Azure Key Vault: CES_SFTP_USER]&lt;br&gt;Password: [from Azure Key Vault: CES_SFTP_PASS]&lt;br&gt;Remote Path: /inbound/unqualified_an/&lt;br&gt;&lt;br&gt;&lt;b&gt;File Format:&lt;/b&gt;&lt;br&gt;Filename: CES_Unqualified_AN_YYYYMMDD.csv&lt;br&gt;Format: CSV with header&lt;br&gt;Column: vehicle_no&lt;br&gt;Example: SHB1234U&lt;br&gt;&lt;br&gt;Timeout: 60s | Retry: 3 attempts" vertex="1">
          <mxGeometry height="280" width="380" x="2540" y="380" as="geometry" />
        </mxCell>
        <mxCell id="edge_upload_ces_info_310" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" target="info_ces_sftp_310" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-30" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" target="PEkpuAo8z3JMSkmCLv0X-28">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-31" connectable="0" parent="PEkpuAo8z3JMSkmCLv0X-30" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="no" vertex="1">
          <mxGeometry relative="1" x="-0.1667" y="-2" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-36" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-33" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="PEkpuAo8z3JMSkmCLv0X-35">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-33" parent="lane_backend_310" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Log Upload Success&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;(CES)&lt;/span&gt;" vertex="1">
          <mxGeometry height="100" width="180" x="3360" y="60" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-38" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-35" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="PEkpuAo8z3JMSkmCLv0X-37">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-35" parent="lane_backend_310" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Update Notice Status&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;(unqualified_list_sent_flag=&#39;Y&#39;)&lt;/span&gt;" vertex="1">
          <mxGeometry height="100" width="180" x="3710" y="60" as="geometry" />
        </mxCell>
        <mxCell id="edge_decision_ces_no_310" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="PEkpuAo8z3JMSkmCLv0X-35" value="NO">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2310" y="20" />
              <mxPoint x="3800" y="20" />
            </Array>
            <mxPoint x="3020" y="110" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-40" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-37" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="PEkpuAo8z3JMSkmCLv0X-39">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-37" parent="lane_backend_310" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Log Transmission Result&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;(Application Log)&lt;/span&gt;" vertex="1">
          <mxGeometry height="100" width="180" x="4010" y="60" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-39" parent="lane_backend_310" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Log Cron Complete&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;(Summary)&lt;/span&gt;" vertex="1">
          <mxGeometry height="100" width="180" x="4290" y="60" as="geometry" />
        </mxCell>
        <mxCell id="info_cron_310" parent="lane_backend_310" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;verticalAlign=top;fontSize=12;" value="&lt;b&gt;Cron Job Configuration:&lt;/b&gt;&lt;br&gt;Schedule: Daily at 02:00 AM SGT&lt;br&gt;Date Range: Previous day (00:00:00 to 23:59:59)&lt;br&gt;Transmission: SFTP file upload&lt;br&gt;Max Retry: 3 attempts per upload&lt;br&gt;Timeout: 60 seconds per SFTP connection" vertex="1">
          <mxGeometry height="120" width="380" x="4190" y="240" as="geometry" />
        </mxCell>
        <mxCell id="edge_log_cron_info_310" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-39" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" target="info_cron_310" value="">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="4640" y="140" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="end_310" parent="lane_backend_310" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.start_1;whiteSpace=wrap;fillColor=#f5f5f5;strokeColor=#666666;fontSize=13;fontColor=#333333;" value="End" vertex="1">
          <mxGeometry height="60" width="120" x="4530" y="80" as="geometry" />
        </mxCell>
        <mxCell id="edge_complete_end_310" edge="1" parent="lane_backend_310" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="end_310" value="">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="4470" y="110" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="info_repccs_sftp_310" parent="lane_backend_310" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;verticalAlign=top;fontSize=11;" value="&lt;b&gt;REPCCS SFTP Details:&lt;/b&gt;&lt;br&gt;Protocol: SFTP&lt;br&gt;Server: [from Azure Key Vault: REPCCS_SFTP_HOST]&lt;br&gt;Port: 22&lt;br&gt;Username: [from Azure Key Vault: REPCCS_SFTP_USER]&lt;br&gt;Password: [from Azure Key Vault: REPCCS_SFTP_PASS]&lt;br&gt;Remote Path: /inbound/unqualified_an/&lt;br&gt;&lt;br&gt;&lt;b&gt;File Format:&lt;/b&gt;&lt;br&gt;Filename: REPCCS_Unqualified_AN_YYYYMMDD.csv&lt;br&gt;Format: CSV with header&lt;br&gt;Column: vehicle_no&lt;br&gt;Example: SHB1234U&lt;br&gt;&lt;br&gt;Timeout: 60s | Retry: 3 attempts" vertex="1">
          <mxGeometry height="280" width="380" x="1290" y="410" as="geometry" />
        </mxCell>
        <mxCell id="edge_upload_repccs_info_310" edge="1" parent="lane_backend_310" source="PEkpuAo8z3JMSkmCLv0X-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" target="info_repccs_sftp_310" value="">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2280" y="140" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="info_unqualified_310" parent="lane_backend_310" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;verticalAlign=top;fontSize=12;" value="&lt;b&gt;Unqualified Criteria (Ref: Tab 3.1 Qualification Check):&lt;/b&gt;&lt;br&gt;&lt;br&gt;A notice is UNQUALIFIED (an_flag=&#39;N&#39; or NULL) when:&lt;br&gt;&lt;br&gt;1. &lt;b&gt;Offence Type:&lt;/b&gt; offence_notice_type != &#39;O&#39;&lt;br&gt;2. &lt;b&gt;Vehicle Type:&lt;/b&gt; vehicle_registration_type NOT IN (&#39;S&#39;,&#39;D&#39;,&#39;V&#39;,&#39;I&#39;)&lt;br&gt;3. &lt;b&gt;Exempt Offence:&lt;/b&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;- Rule 20412 with composition_amount = $80&lt;br&gt;&amp;nbsp;&amp;nbsp;- Rule 11210 with vehicle_category &#39;LB&#39; or &#39;HL&#39;&lt;br&gt;4. &lt;b&gt;No Past Offence:&lt;/b&gt; No qualifying offence in past 24 months&lt;br&gt;&lt;br&gt;&lt;i&gt;Note: an_flag is set during notice creation (Tab 3.2/3.3)&lt;br&gt;based on AN Qualification Check result (Tab 3.1)&lt;br&gt;CES source: an_flag from payload, no qualification check&lt;/i&gt;" vertex="1">
          <mxGeometry height="220" width="420" x="530" y="340" as="geometry" />
        </mxCell>
        <mxCell id="edge_filter_info_310" edge="1" parent="lane_backend_310" source="x6ROZ4C58ZNDYvBh47Pb-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" target="info_unqualified_310" value="">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="790.0000000000002" y="110.00000000000011" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="info_query_310" parent="lane_backend_310" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;verticalAlign=top;fontSize=12;" value="&lt;b&gt;Query for Unqualified ANs:&lt;/b&gt;&lt;br&gt;SELECT notice_no, vehicle_no, subsystem_label,&lt;br&gt;computer_rule_code, composition_amount,&lt;br&gt;notice_date_and_time, offence_notice_type,&lt;br&gt;an_flag, cre_date&lt;br&gt;FROM ocms_valid_offence_notice&lt;br&gt;WHERE cre_date BETWEEN [dateFrom] AND [dateTo]&lt;br&gt;AND (an_flag = &#39;N&#39; OR an_flag IS NULL)&lt;br&gt;AND subsystem_label IN (&#39;REPCCS&#39;, &#39;CES&#39;)&lt;br&gt;ORDER BY subsystem_label, cre_date ASC&lt;br&gt;&lt;br&gt;-- Daily cron sends previous day&#39;s unqualified records" vertex="1">
          <mxGeometry height="200" width="400" x="120" y="340" as="geometry" />
        </mxCell>
        <mxCell id="x6ROZ4C58ZNDYvBh47Pb-2" edge="1" parent="lane_backend_310" source="x6ROZ4C58ZNDYvBh47Pb-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;dashPattern=8 8;" target="info_query_310">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="start_310" parent="1" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.start_1;whiteSpace=wrap;fillColor=#f5f5f5;strokeColor=#666666;fontSize=13;fontColor=#333333;" value="Start" vertex="1">
          <mxGeometry height="60" width="120" x="200" y="160" as="geometry" />
        </mxCell>
        <mxCell id="edge_start_calc_310" edge="1" parent="1" source="start_310" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="x6ROZ4C58ZNDYvBh47Pb-1" value="">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="380" y="190" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="edge_decision_generate_repccs_310" edge="1" parent="1" source="PEkpuAo8z3JMSkmCLv0X-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;" value="YES">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1920" y="190" as="sourcePoint" />
            <mxPoint x="1210" y="190" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="edge_decision_repccs_no_310" edge="1" parent="1" source="PEkpuAo8z3JMSkmCLv0X-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" target="PEkpuAo8z3JMSkmCLv0X-19" value="NO">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1070" y="100" />
              <mxPoint x="2330" y="100" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-1" parent="1" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;direction=south;" value="&lt;span style=&quot;font-size: 13px;&quot;&gt;Any REPCCS&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;Records?&lt;/span&gt;" vertex="1">
          <mxGeometry height="140" width="120" x="1010" y="120" as="geometry" />
        </mxCell>
        <mxCell id="PEkpuAo8z3JMSkmCLv0X-2" edge="1" parent="1" source="x6ROZ4C58ZNDYvBh47Pb-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" target="PEkpuAo8z3JMSkmCLv0X-1" value="">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="820" y="190" as="sourcePoint" />
            <mxPoint x="1780" y="190" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
